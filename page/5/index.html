<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"louis-me.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":true,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="一个正经的测试工程师">
<meta property="og:type" content="website">
<meta property="og:title" content="施坤的博客">
<meta property="og:url" content="https://louis-me.github.io/page/5/index.html">
<meta property="og:site_name" content="施坤的博客">
<meta property="og:description" content="一个正经的测试工程师">
<meta property="og:locale" content="zh_CN">
<meta property="article:tag" content="自动化测试,安全测试,性能测试,渗透测试,大数据测试,python,jmeter,airtest,appium,monkey">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://louis-me.github.io/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>施坤的博客 </title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">施坤的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-简历">

    <a href="/resume/" rel="section"><i class="fa fa-address-card fa-fw"></i>简历</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
  
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/b0b7e6c8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/b0b7e6c8/" class="post-title-link" itemprop="url">web自动化神器playwright</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-10 09:33:25" itemprop="dateCreated datePublished" datetime="2022-10-10T09:33:25+08:00">2022-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-08-02 17:11:09" itemprop="dateModified" datetime="2023-08-02T17:11:09+08:00">2023-08-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/playwright/" itemprop="url" rel="index"><span itemprop="name">playwright</span></a>
                </span>
            </span>

          
            <span id="/aposts/b0b7e6c8/" class="post-meta-item leancloud_visitors" data-flag-title="web自动化神器playwright" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/b0b7e6c8/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/b0b7e6c8/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="playwright"><a href="#playwright" class="headerlink" title="playwright"></a>playwright</h1><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul>
<li><p>Selenium需要通过WebDriver操作浏览器；Playwright通过开发者工具与浏览器交互，安装简洁，不需要安装各种Driver。</p>
</li>
<li><p>Playwright几乎支持所有语言，且不依赖于各种Driver，通过调用内置浏览器所以启动速度更快。</p>
</li>
<li><p>Selenium基于HTTP协议（单向通讯），Playwright基于Websocket（双向通讯）可自动获取浏览器实际情况。</p>
</li>
<li><p>比如使用selenium时，操作元素需要对每个元素进行智能查询等待等，而Playwright为自动等待：</p>
</li>
<li><ul>
<li>等待元素出现（定位元素时，自动等待30s，时间可以自定义，单位毫秒）</li>
<li>等待事件发生</li>
</ul>
</li>
<li><p>Playwright速度比selenium快很多，还支持异步方式</p>
</li>
<li><p>支持使用API的方式发送请求</p>
</li>
</ul>
<h2 id="限制"><a href="#限制" class="headerlink" title="限制"></a>限制</h2><ul>
<li>不支持旧版Edge和IE11。Playwright不支持传统的Microsoft Edge或IE11，支持新的Microsoft Edge (在Chromium上)。</li>
<li>在真实移动设备上测试: Playwright使用桌面浏览器来模拟移动设备。</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#升级pip</span><br><span class="line">pip install --upgrade pip</span><br><span class="line">#安装playwright模块</span><br><span class="line">pip install playwright</span><br><span class="line">#安装主流浏览器依赖,时间可能较久</span><br><span class="line">playwright install</span><br></pre></td></tr></table></figure>

<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ul>
<li>录制代码，输入下面的命令，启动一个浏览器，一个代码记录器，然后再浏览器的所有步骤都自动记录到了代码记录器中</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m playwright codegen</span><br></pre></td></tr></table></figure>

<p><img src="/aposts/b0b7e6c8/image-20221011105539960.png" alt="image-20221011105539960"></p>
<ul>
<li>录制代码如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> playwright.sync_api <span class="keyword">import</span> Playwright, sync_playwright, expect</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">playwright: Playwright</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    browser = playwright.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line">    context = browser.new_context()</span><br><span class="line">    page = context.new_page()</span><br><span class="line">    page.goto(<span class="string">&quot;https://www.baidu.com/&quot;</span>)</span><br><span class="line">    page.locator(<span class="string">&quot;input[name=\&quot;wd\&quot;]&quot;</span>).click()</span><br><span class="line">    page.locator(<span class="string">&quot;input[name=\&quot;wd\&quot;]&quot;</span>).fill(<span class="string">&quot;python&quot;</span>)</span><br><span class="line">    page.get_by_role(<span class="string">&quot;button&quot;</span>, name=<span class="string">&quot;百度一下&quot;</span>).click()</span><br><span class="line">    page.wait_for_url(<span class="string">&quot;https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=1&amp;rsv_idx=1&amp;tn=baidu&amp;wd=python&amp;fenlei=256&amp;rsv_pq=0xc3da98d700012600&amp;rsv_t=a363ozUooWOMdrOI3S3PH3JauszohenVsQYNmRX6SyweDX91MOi0p89Sb4HG&amp;rqlang=en&amp;rsv_enter=0&amp;rsv_dl=tb&amp;rsv_sug3=6&amp;rsv_sug1=1&amp;rsv_sug7=100&amp;rsv_btype=i&amp;inputT=1846&amp;rsv_sug4=1847&amp;rsv_jmp=fail&quot;</span>)</span><br><span class="line">    <span class="comment"># ---------------------</span></span><br><span class="line">    context.close()</span><br><span class="line">    browser.close()</span><br><span class="line"><span class="keyword">with</span> sync_playwright() <span class="keyword">as</span> playwright:</span><br><span class="line">    run(playwright)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>通过以上代码可以了解到：</p>
<ul>
<li><p>playwright支持同步和异步两种使用方法</p>
</li>
<li><p>不需要为每个浏览器下载webdriver</p>
</li>
<li><p>相比selenium多了一层context抽象</p>
</li>
<li><p>支持无头浏览器，且较为推荐（headless默认值为True）</p>
</li>
<li><p>可以使用传统定位方式（CSS，XPATH等），也有自定义的新的定位方式（如文字定位）</p>
</li>
<li><p>没有使用selenium的先定位元素，再进行操作的方式，而是在操作方法中传入了元素定位，定位和操作同时进行（其实也playwright也提供了单独的定位方法，作为可选）</p>
</li>
<li><p>很多方法使用了with的上下文语法</p>
</li>
<li><p>当然更多的人愿意在Pycharm中手写用例</p>
</li>
</ul>
<h2 id="playwright基本概念"><a href="#playwright基本概念" class="headerlink" title="playwright基本概念"></a>playwright基本概念</h2><ul>
<li>来做<a target="_blank" rel="noopener" href="https://blog.csdn.net/Code_LT/article/details/120291277?spm=1001.2101.3001.6650.5&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-5-120291277-blog-125575408.t0_edu_mix&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-5-120291277-blog-125575408.t0_edu_mix&utm_relevant_index=6">这里</a></li>
</ul>
<p>PlayWright的核心概念包括：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/core-concepts#browser">Browser</a></li>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/core-concepts#browser-contexts">Browser contexts</a></li>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/core-concepts#pages-and-frames">Pages and frames</a></li>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/core-concepts#selectors">Selectors</a></li>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/core-concepts#auto-waiting">Auto-waiting</a></li>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/core-concepts#execution-contexts-playwright-and-browser">Execution contexts: Playwright and Browser</a></li>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/core-concepts#evaluation-argument">Evaluation Argument</a></li>
</ul>
<h3 id="Browser"><a href="#Browser" class="headerlink" title="Browser"></a>Browser</h3><ul>
<li>一个Browser是一个Chromium, Firefox 或 WebKit（plarywright支持的三种浏览器）的实例plarywright脚本通常以启动浏览器实例开始，以关闭浏览器结束。浏览器实例可以在headless（没有 GUI）或head模式下启动。Browser实例创建：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> playwright.sync_api <span class="keyword">import</span> sync_playwright</span><br><span class="line"> </span><br><span class="line"><span class="keyword">with</span> sync_playwright() <span class="keyword">as</span> p:</span><br><span class="line">    browser = p.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line">    browser.close()</span><br></pre></td></tr></table></figure>

<ul>
<li>启动browser实例是比较耗费资源的，plarywright做的就是如何通过一个browser实例最大化多个BrowserContext的性能。</li>
<li>API:<a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-browser">Browser</a></li>
</ul>
<h3 id="BrowserContext"><a href="#BrowserContext" class="headerlink" title="BrowserContext"></a>BrowserContext</h3><ul>
<li><p>一个BrowserContex就像是一个独立的匿名模式会话（session），非常轻量，但是又完全隔离。</p>
</li>
<li><p>（译者注：每个browser实例可有多个BrowserContex，且完全隔离。比如可以在两个BrowserContext中登录两个不同的账号，也可以在两个 context 中使用不同的代理。 ）</p>
</li>
<li><p>context创建：</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">browser = playwright.chromium.launch()</span><br><span class="line">context = browser.new_context()</span><br></pre></td></tr></table></figure>

<ul>
<li>context还可用于模拟涉及移动设备、权限、区域设置和配色方案的多页面场景，如移动端context创建：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> playwright.sync_api <span class="keyword">import</span> sync_playwright</span><br><span class="line"> </span><br><span class="line"><span class="keyword">with</span> sync_playwright() <span class="keyword">as</span> p:</span><br><span class="line">    iphone_11 = p.devices[<span class="string">&#x27;iPhone 11 Pro&#x27;</span>]</span><br><span class="line">    browser = p.webkit.launch(headless=<span class="literal">False</span>)</span><br><span class="line">    context = browser.new_context(</span><br><span class="line">        **iphone_11,</span><br><span class="line">        locale=<span class="string">&#x27;de-DE&#x27;</span>,</span><br><span class="line">        geolocation=&#123; <span class="string">&#x27;longitude&#x27;</span>: <span class="number">12.492507</span>, <span class="string">&#x27;latitude&#x27;</span>: <span class="number">41.889938</span> &#125;,</span><br><span class="line">        permissions=[<span class="string">&#x27;geolocation&#x27;</span>]</span><br><span class="line">    )</span><br><span class="line">    browser.close()</span><br></pre></td></tr></table></figure>

<p>API:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-browsercontext">BrowserContext</a></li>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-browser#browser-new-context">browser.new_context(**kwargs)</a></li>
</ul>
<h3 id="Page-和-Frame"><a href="#Page-和-Frame" class="headerlink" title="Page 和 Frame"></a>Page 和 Frame</h3><ul>
<li>一个BrowserContext可以有多个page，每个page代表一个tab或者一个弹窗。page用于导航到URL并与page内的内容交互。创建page:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">page = context.new_page()</span><br><span class="line"> </span><br><span class="line"># Navigate explicitly, similar to entering a URL in the browser.</span><br><span class="line">page.goto(&#x27;http://example.com&#x27;)</span><br><span class="line"># Fill an input.</span><br><span class="line">page.fill(&#x27;#search&#x27;, &#x27;query&#x27;)</span><br><span class="line"> </span><br><span class="line"># Navigate implicitly by clicking a link.</span><br><span class="line">page.click(&#x27;#submit&#x27;)</span><br><span class="line"># Expect a new url.</span><br><span class="line">print(page.url)</span><br><span class="line"> </span><br><span class="line"># Page can navigate from the script - this will be picked up by Playwright.</span><br><span class="line"># window.location.href = &#x27;https://example.com&#x27;</span><br></pre></td></tr></table></figure>

<ul>
<li>一个page可以有多个frame对象，但只有一个主frame，所有page-level的操作(比如click），都是作用在主frame上的。page的其他frame会打上<code>iframe</code> HTML标签，这些frame可以在内部操作实现访问。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过name属性获取frame</span></span><br><span class="line">frame = page.frame(<span class="string">&#x27;frame-login&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 通过URL获取frame</span></span><br><span class="line">frame = page.frame(url=<span class="string">r&#x27;.*domain.*&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 通过其他选择器(selector)获取frame</span></span><br><span class="line">frame_element_handle = page.query_selector(<span class="string">&#x27;.frame-class&#x27;</span>)</span><br><span class="line">frame = frame_element_handle.content_frame()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 与frame交互</span></span><br><span class="line">frame.fill(<span class="string">&#x27;#username-input&#x27;</span>, <span class="string">&#x27;John&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>在录制模式下，会自动识别是否是frame内的操作，不好定位frame时，那么可以使用录制模式来找。</li>
</ul>
<p>API：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-page">Page</a></li>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-frame">Frame</a></li>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-page#page-frame">page.frame(**kwargs</a></li>
</ul>
<h3 id="Selector"><a href="#Selector" class="headerlink" title="Selector"></a>Selector</h3><ul>
<li><p>playwright可以通过 CSS selector, XPath selector, HTML 属性（比如 <code>id</code>, <code>data-test-id）或者是文本内容</code>定位元素。</p>
</li>
<li><p>除了xpath selector外，所有selector默认都是指向shadow DOM，如果要指向常规DOM，可使用*:light。不过通常不需要。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Using data-test-id= selector engine</span></span><br><span class="line">page.click(<span class="string">&#x27;data-test-id=foo&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># CSS and XPath selector engines are automatically detected</span></span><br><span class="line">page.click(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">page.click(<span class="string">&#x27;//html/body/div&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Find node by text substring</span></span><br><span class="line">page.click(<span class="string">&#x27;text=Hello w&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Explicit CSS and XPath notation</span></span><br><span class="line">page.click(<span class="string">&#x27;css=div&#x27;</span>)</span><br><span class="line">page.click(<span class="string">&#x27;xpath=//html/body/div&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Only search light DOM, outside WebComponent shadow DOM:</span></span><br><span class="line">page.click(<span class="string">&#x27;css:light=div&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 不同的selector可组合使用，用 &gt;&gt;连接</span></span><br><span class="line"><span class="comment"># Click an element with text &#x27;Sign Up&#x27; inside of a #free-month-promo.</span></span><br><span class="line">page.click(<span class="string">&#x27;#free-month-promo &gt;&gt; text=Sign Up&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Capture textContent of a section that contains an element with text &#x27;Selectors&#x27;.</span></span><br><span class="line">section_text = page.eval_on_selector(<span class="string">&#x27;*css=section &gt;&gt; text=Selectors&#x27;</span>, <span class="string">&#x27;e =&gt; e.textContent&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>详细：</p>
<p><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/selectors/">Element selectors | Playwright Python</a></p>
<h3 id="Auto-waiting"><a href="#Auto-waiting" class="headerlink" title="Auto-waiting"></a>Auto-waiting</h3><ul>
<li><p>playwright在执行操作之前对元素执行一系列可操作性检查，以确保这些行动按预期运行。它会自动等待（auto-wait）所有相关检查通过，然后才执行请求的操作。如果所需的检查未在给定的范围内通过timeout，则操作将失败并显示TimeoutError </p>
</li>
<li><p>如 page.click(selector, **kwargs) 和 page.fill(selector, value, **kwargs) 这样的操作会执行auto-wait ，等待元素变成可见（visible）和 可操作（ actionable）。例如，click将会:</p>
<ul>
<li><p>等待selectorx选定元素出现在 DOM 中</p>
</li>
<li><p>待它变得可见（visible）：有非空的边界框且没有 <code>visibility:hidden</code></p>
</li>
<li><p>等待它停止移动：例如，等待 css 过渡（css transition）完成</p>
</li>
<li><p>将元素滚动到视图中</p>
</li>
<li><p>等待它在动作点接收点事件：例如，等待元素不被其他元素遮挡</p>
</li>
<li><p>如果在上述任何检查期间元素被分离，则重试</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Playwright waits for #search element to be in the DOM</span></span><br><span class="line">page.fill(<span class="string">&#x27;#search&#x27;</span>, <span class="string">&#x27;query&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Playwright waits for element to stop animating</span></span><br><span class="line"><span class="comment"># and accept clicks.</span></span><br><span class="line">page.click(<span class="string">&#x27;#search&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#也可显示执行等待动作</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Wait for #search to appear in the DOM.</span></span><br><span class="line">page.wait_for_selector(<span class="string">&#x27;#search&#x27;</span>, state=<span class="string">&#x27;attached&#x27;</span>)</span><br><span class="line"><span class="comment"># Wait for #promo to become visible, for example with `visibility:visible`.</span></span><br><span class="line">page.wait_for_selector(<span class="string">&#x27;#promo&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Wait for #details to become hidden, for example with `display:none`.</span></span><br><span class="line">page.wait_for_selector(<span class="string">&#x27;#details&#x27;</span>, state=<span class="string">&#x27;hidden&#x27;</span>)</span><br><span class="line"><span class="comment"># Wait for #promo to be removed from the DOM.</span></span><br><span class="line">page.wait_for_selector(<span class="string">&#x27;#promo&#x27;</span>, state=<span class="string">&#x27;detached&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Execution-context"><a href="#Execution-context" class="headerlink" title="Execution context"></a>Execution context</h3><ul>
<li>API <a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-page#page-evaluate">page.evaluate(expression, **kwargs)</a> 可以用来运行web页面中的 JavaScript函数，并将结果返回到plarywright环境中。浏览器的全局变量，如 <code>window</code> 和 <code>document，</code> 可用于 <code>evaluate。</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">href = page.evaluate(<span class="string">&#x27;() =&gt; document.location.href&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># if the result is a Promise or if the function is asynchronous evaluate will automatically wait until it&#x27;s resolved</span></span><br><span class="line"> </span><br><span class="line">status = page.evaluate(<span class="string">&quot;&quot;&quot;async () =&gt; &#123;</span></span><br><span class="line"><span class="string">  response = fetch(location.href)</span></span><br><span class="line"><span class="string">  return response.status</span></span><br><span class="line"><span class="string">&#125;&quot;&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Evaluation-Argument"><a href="#Evaluation-Argument" class="headerlink" title="Evaluation Argument"></a>Evaluation Argument</h3><ul>
<li><a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-page#page-evaluate">page.evaluate(expression, **kwargs)</a> 方法接收单个可选参数。此参数可以是<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#Description">Serializable</a>值和<a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-jshandle">JSHandle</a>或<a target="_blank" rel="noopener" href="https://playwright.dev/python/docs/api/class-elementhandle">ElementHandle</a>实例的混合。句柄会自动转换为它们所代表的值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">result = page.evaluate(<span class="string">&quot;([x, y]) =&gt; Promise.resolve(x * y)&quot;</span>, [<span class="number">7</span>, <span class="number">8</span>])</span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment"># prints &quot;56&quot;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(page.evaluate(<span class="string">&quot;1 + 2&quot;</span>)) <span class="comment"># prints &quot;3&quot;</span></span><br><span class="line">x = <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(page.evaluate(<span class="string">f&quot;1 + <span class="subst">&#123;x&#125;</span>&quot;</span>)) <span class="comment"># prints &quot;11&quot;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">body_handle = page.query_selector(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">html = page.evaluate(<span class="string">&quot;([body, suffix]) =&gt; body.innerHTML + suffix&quot;</span>, [body_handle, <span class="string">&quot;hello&quot;</span>])</span><br><span class="line">body_handle.dispose()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># A primitive value.</span></span><br><span class="line">page.evaluate(<span class="string">&#x27;num =&gt; num&#x27;</span>, <span class="number">42</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># An array.</span></span><br><span class="line">page.evaluate(<span class="string">&#x27;array =&gt; array.length&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># An object.</span></span><br><span class="line">page.evaluate(<span class="string">&#x27;object =&gt; object.foo&#x27;</span>, &#123; <span class="string">&#x27;foo&#x27;</span>: <span class="string">&#x27;bar&#x27;</span> &#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># A single handle.</span></span><br><span class="line">button = page.query_selector(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">page.evaluate(<span class="string">&#x27;button =&gt; button.textContent&#x27;</span>, button)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Alternative notation using elementHandle.evaluate.</span></span><br><span class="line">button.evaluate(<span class="string">&#x27;(button, from) =&gt; button.textContent.substring(from)&#x27;</span>, <span class="number">5</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Object with multiple handles.</span></span><br><span class="line">button1 = page.query_selector(<span class="string">&#x27;.button1&#x27;</span>)</span><br><span class="line">button2 = page.query_selector(<span class="string">&#x27;.button2&#x27;</span>)</span><br><span class="line">page.evaluate(<span class="string">&quot;&quot;&quot;o =&gt; o.button1.textContent + o.button2.textContent&quot;&quot;&quot;</span>,</span><br><span class="line">    &#123; <span class="string">&#x27;button1&#x27;</span>: button1, <span class="string">&#x27;button2&#x27;</span>: button2 &#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Object destructuring works. Note that property names must match</span></span><br><span class="line"><span class="comment"># between the destructured object and the argument.</span></span><br><span class="line"><span class="comment"># Also note the required parenthesis.</span></span><br><span class="line">page.evaluate(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    (&#123; button1, button2 &#125;) =&gt; button1.textContent + button2.textContent&quot;&quot;&quot;</span>,</span><br><span class="line">    &#123; <span class="string">&#x27;button1&#x27;</span>: button1, <span class="string">&#x27;button2&#x27;</span>: button2 &#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Array works as well. Arbitrary names can be used for destructuring.</span></span><br><span class="line"><span class="comment"># Note the required parenthesis.</span></span><br><span class="line">page.evaluate(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ([b1, b2]) =&gt; b1.textContent + b2.textContent&quot;&quot;&quot;</span>,</span><br><span class="line">    [button1, button2])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Any non-cyclic mix of serializables and handles works.</span></span><br><span class="line">page.evaluate(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    x =&gt; x.button1.textContent + x.list[0].textContent + String(x.foo)&quot;&quot;&quot;</span>,</span><br><span class="line">    &#123; <span class="string">&#x27;button1&#x27;</span>: button1, <span class="string">&#x27;list&#x27;</span>: [button2], <span class="string">&#x27;foo&#x27;</span>: <span class="literal">None</span> &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="结合pytest"><a href="#结合pytest" class="headerlink" title="结合pytest"></a>结合pytest</h2><ul>
<li>testcas\conftest.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">from</span> playwright.sync_api <span class="keyword">import</span> sync_playwright</span><br><span class="line"><span class="keyword">from</span> py._xmlgen <span class="keyword">import</span> html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">browser</span>():</span><br><span class="line">    playwrigh = sync_playwright().start()</span><br><span class="line">    browser = playwrigh.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回数据</span></span><br><span class="line">    <span class="keyword">yield</span> browser</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 实现用例后置</span></span><br><span class="line">    browser.close()</span><br><span class="line">    playwrigh.stop()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.mark.hookwrapper</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pytest_runtest_makereport</span>(<span class="params">item, call</span>):</span><br><span class="line">    outcome = <span class="keyword">yield</span></span><br><span class="line">    report = outcome.get_result()</span><br><span class="line">    report.description = <span class="built_in">str</span>(item.function.__doc__)</span><br><span class="line">    report.nodeid = report.nodeid.encode(<span class="string">&quot;utf-8&quot;</span>).decode(<span class="string">&quot;unicode_escape&quot;</span>)  <span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pytest_html_results_table_header</span>(<span class="params">cells</span>):</span><br><span class="line">    cells.insert(<span class="number">1</span>, html.th(<span class="string">&#x27;用例名称&#x27;</span>))</span><br><span class="line">    cells.insert(<span class="number">2</span>, html.th(<span class="string">&#x27;Test_nodeid&#x27;</span>))</span><br><span class="line">    cells.pop(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pytest_html_results_table_row</span>(<span class="params">report, cells</span>):</span><br><span class="line">    cells.insert(<span class="number">1</span>, html.td(report.description))</span><br><span class="line">    cells.insert(<span class="number">2</span>, html.td(report.nodeid))</span><br><span class="line">    cells.pop(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pytest_html_results_table_html</span>(<span class="params">report, data</span>):</span><br><span class="line">    <span class="keyword">if</span> report.passed:</span><br><span class="line">        <span class="keyword">del</span> data[:]</span><br><span class="line">        data.append(html.div(<span class="string">&#x27;通过的用例未捕获日志输出.&#x27;</span>, class_=<span class="string">&#x27;empty log&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pytest_html_report_title</span>(<span class="params">report</span>):</span><br><span class="line">    report.title = <span class="string">&quot;pytest示例项目测试报告&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>testcase\test1.py，<code>page.request.ge</code>t可以直接发送请求</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import pytest</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class TestClassName:</span><br><span class="line">    @pytest.mark.usefixtures(&quot;browser&quot;)</span><br><span class="line">    def test_func_name1(self, browser):</span><br><span class="line">        context = browser.new_context()</span><br><span class="line">        page = context.new_page()</span><br><span class="line">        # 发送http请求</span><br><span class="line">        resp = page.request.get(&quot;http://www.kuaidi100.com/query?type=&quot;)</span><br><span class="line">        print(resp.text())</span><br><span class="line">        page.goto(&quot;https://www.baidu.com/&quot;)</span><br><span class="line">        assert page.title() == &quot;百度一下，你就知道&quot;</span><br><span class="line">        </span><br><span class="line">        page.locator(&quot;input[name=\&quot;wd\&quot;]&quot;).click()</span><br><span class="line">        page.locator(&quot;input[name=\&quot;wd\&quot;]&quot;).fill(&quot;python&quot;)</span><br><span class="line">        page.get_by_role(&quot;button&quot;, name=&quot;百度一下&quot;).click()</span><br><span class="line">        context.close()</span><br><span class="line"></span><br><span class="line">    @pytest.mark.usefixtures(&quot;browser&quot;)</span><br><span class="line">    def test_func_name1_1(self, browser):</span><br><span class="line">        context = browser.new_context()</span><br><span class="line">        page = context.new_page()</span><br><span class="line">        page.goto(&quot;https://www.baidu.com/&quot;)</span><br><span class="line">        assert page.title() == &quot;百度一下，你就知道1&quot;</span><br><span class="line">        page.locator(&quot;input[name=\&quot;wd\&quot;]&quot;).click()</span><br><span class="line">        page.locator(&quot;input[name=\&quot;wd\&quot;]&quot;).fill(&quot;python&quot;)</span><br><span class="line">        page.get_by_role(&quot;button&quot;, name=&quot;百度一下&quot;).click()</span><br><span class="line">        context.close()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>执行用例</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 批量运行用例</span><br><span class="line">pytest -s testcase\  --html=report.html --self-contained-html --capture=sys</span><br><span class="line"></span><br><span class="line"># 多线程运行用例 </span><br><span class="line">pip install pytest-multithreading -i https://pypi.douban.com/simple</span><br><span class="line">pytest -s testcase/ --th 10 --html=report.html --self-contained-html --capture=sys</span><br></pre></td></tr></table></figure>

<ul>
<li>查看执行结果</li>
</ul>
<p><img src="/aposts/b0b7e6c8/image-20221011152104439.png" alt="image-20221011152104439"></p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>如何集成到CI上待实践</li>
<li>关于多机并行，可以多进程去启动，也可以在CI上新建几个节点去执行</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/4d250642/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/4d250642/" class="post-title-link" itemprop="url">ab压力测试-突破最大线程数</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-08 09:22:27" itemprop="dateCreated datePublished" datetime="2022-10-08T09:22:27+08:00">2022-10-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-10-09 10:38:14" itemprop="dateModified" datetime="2022-10-09T10:38:14+08:00">2022-10-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">性能测试</span></a>
                </span>
            </span>

          
            <span id="/aposts/4d250642/" class="post-meta-item leancloud_visitors" data-flag-title="ab压力测试-突破最大线程数" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/4d250642/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/4d250642/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/166a4ea8aade">ab压力测试中，发现你一次最多只能启动1024个线程</a></p>
</blockquote>
<ul>
<li>默认情况下，一个线程的栈要预留1M的内存空间<br>而一个进程中可用的内存空间只有2G，所以理论上一个进程中最多可以开2048个线程</li>
<li>但是内存当然不可能完全拿来作线程的栈，所以实际数目要比这个值要小。你也可以通过连接时修改默认栈大小，将其改的比较小，这样就可以多开一些线程。如将默认栈的大小改成512K，这样理论上最多就可以开4096个线程。即使物理内存再大，一个进程中可以起的线程总要受到2GB这个内存空间的限制。</li>
<li>比方说你的机器装了64GB物理内存，但每个进程的内存空间还是4GB，其中用户态可用的还是2GB。<ul>
<li>内核态. CPU可以访问内存所有数据, 包括外围设备, 例如硬盘, 网卡. CPU也可以将自己从一个程序切换到另一个程序</li>
<li>用户态:.只能受限的访问内存, 且不允许访问外围设备. 占用CPU的能力被剥夺, CPU资源可以被其他程序获取</li>
</ul>
</li>
<li>如果是同一台机器内的话，能起多少线程也是受内存限制的。每个线程对象都要站用非页面内存，而非页面内存也是有限的，当非页面内存被耗尽时，也就无法创建线程了。</li>
<li>如果物理内存非常大，同一台机器内可以跑的线程数目的限制值会越来越大。在Windows下写个程序，一个进程Fork出2000个左右线程就会异常退出了，为什么？这个问题的产生是因为windows32位系统，一个进程所能使用的最大虚拟内存为2G，而一个线程的默认线程栈StackSize为1024K（1M），这样当线程数量逼近2000时，2000*1024K&#x3D;2G（大约），内存资源就相当于耗尽</li>
</ul>
<h1 id="影响最大线程大小的因素"><a href="#影响最大线程大小的因素" class="headerlink" title="影响最大线程大小的因素"></a>影响最大线程大小的因素</h1><ul>
<li>Java虚拟机本身<ul>
<li>Xms 初始堆大小</li>
<li>Xmx 最大堆大小</li>
<li>Xss 每个线程的堆栈大小</li>
</ul>
</li>
<li>系统限制<ul>
<li>&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;pid_max</li>
<li>&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;thread-max</li>
<li>max_user_process（ulimit -u）</li>
<li>&#x2F;proc&#x2F;sys&#x2F;vm&#x2F;max_map_count</li>
</ul>
</li>
</ul>
<h1 id="其他突破线程问题"><a href="#其他突破线程问题" class="headerlink" title="其他突破线程问题"></a>其他突破线程问题</h1><ul>
<li>多进程-启动多线程</li>
<li>使用异步请求<ul>
<li>无论是使用多进程-多线程，还是异步请求，最主要的影响还是电脑本身的配置</li>
</ul>
</li>
</ul>
<h2 id="下面是具体配置"><a href="#下面是具体配置" class="headerlink" title="下面是具体配置"></a>下面是具体配置</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p><code>httpd.exe -l </code>会看见 <code>mpm_winnt.c windows</code>默认执行 <code>mpm_winnt_module</code>方式 (暂未找到修改成其他方式的方法)</p>
<p>1.<code>httpd.conf</code> 文件去掉 <code>Include conf/extra/httpd-mpm.conf</code> 前面的#</p>
<p>2.修改<code>extra/httpd-mpm.conf</code> 最下面 或 查找 <code>mpm_winnt_module</code> 修改<code>ThreadsPerChild</code> 和 <code>MaxRequestsPerChild</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#每个子进程建立的线程数</span><br><span class="line">    ThreadsPerChild      1 默认150</span><br><span class="line"></span><br><span class="line">    #指令设置每个子进程在其生存期内允许伺服的最大请求数量。</span><br><span class="line">    #到达MaxRequestsPerChild的限制后，子进程将会结束。</span><br><span class="line">    #如果MaxRequestsPerChild为&quot;0&quot;，子进程将永远不会结束。</span><br><span class="line">    MaxRequestsPerChild    10  默认0</span><br></pre></td></tr></table></figure>

<p>根据自己网站并发数量设置:</p>
<ul>
<li><code>ThreadsPerChild</code> 设置 网站平均在线人数</li>
<li><code>MaxRequestsPerChild</code> 设置最高在线人数的值</li>
</ul>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><ul>
<li><p><code>ps -ef | grep httpd | wc -l </code>查看当前 httpd进程数</p>
</li>
<li><p><code>apachectl -l </code>会看见 prefork.c Linux默认执行 mpm_prefork_module</p>
</li>
<li><p><code>httpd.conf</code> 文件去掉 <code>Include conf/extra/httpd-mpm.conf </code>前面的#</p>
</li>
<li><p>修改<code>extra/httpd-mpm.conf</code> 最上面 或 查找 <code>mpm_prefork_module</code></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">StartServers          5 #默认启动线程数</span><br><span class="line"></span><br><span class="line">    #指令设置空闲子进程的最小数量。</span><br><span class="line">    #所谓空闲子进程是指没有正在处理请求的子进程。</span><br><span class="line">    #如果当前空闲子进程数少于MinSpareServers ，</span><br><span class="line">    #那么Apache将以最大每秒一个的速度产生新的子进程。</span><br><span class="line">    #只有在非常繁忙机器上才需要调整这个参数。将此参数设的太大通常是一个坏主意。</span><br><span class="line">    MinSpareServers       5 #</span><br><span class="line"></span><br><span class="line">    #指令设置空闲子进程的最大数量。</span><br><span class="line">    #所谓空闲子进程是指没有正在处理请求的子进程。</span><br><span class="line">    #如果当前有超过MaxSpareServers数量的空闲子进程，</span><br><span class="line">    #那么父进程将杀死多余的子进程。</span><br><span class="line">    #只有在非常繁忙机器上才需要调整这个参数。</span><br><span class="line">    #将此参数设的太大通常是一个坏主意。</span><br><span class="line">    #如果你将该指令的值设置为比MinSpareServers小，</span><br><span class="line">    #Apache将会自动将其修改成&quot;MinSpareServers+1&quot;。</span><br><span class="line">    MaxSpareServers      10 #</span><br><span class="line">    MaxClients          150 #apache可以同时处理的请求</span><br><span class="line">    MaxRequestsPerChild   0  #如windows MaxRequestsPerChild</span><br></pre></td></tr></table></figure>

<h1 id="其他参考"><a href="#其他参考" class="headerlink" title="其他参考"></a>其他参考</h1><ul>
<li><a target="_blank" rel="noopener" href="http://jzhihui.iteye.com/blog/1271122">JVM中可生成的最大Thread数量</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cnblogs.com/zemliu/p/3695503.html">内核态(Kernel Mode)与用户态(User Mode)</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/5639d3cc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/5639d3cc/" class="post-title-link" itemprop="url">pc自动化调研</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-09-27 11:38:42" itemprop="dateCreated datePublished" datetime="2022-09-27T11:38:42+08:00">2022-09-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-10-09 10:32:15" itemprop="dateModified" datetime="2022-10-09T10:32:15+08:00">2022-10-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">自动化测试</span></a>
                </span>
            </span>

          
            <span id="/aposts/5639d3cc/" class="post-meta-item leancloud_visitors" data-flag-title="pc自动化调研" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/5639d3cc/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/5639d3cc/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="关于PC自动化"><a href="#关于PC自动化" class="headerlink" title="关于PC自动化"></a>关于PC自动化</h2><p>无论使用那种PC自动化工具，首先需要知道应用程序是<code>win32 API</code> 的 <code>backend</code> 为<code>「 win32 」</code>，还是<code>MS UI Automation</code> 的 <code>backend</code> 为<code>「 uia 」</code></p>
<h2 id="WinAppDriver"><a href="#WinAppDriver" class="headerlink" title="WinAppDriver"></a>WinAppDriver</h2><ul>
<li><p>它支持 Appium，可以使用 Appium-Python-Client 依赖库完成对 Windows 桌面程序的自动化操作</p>
</li>
<li><p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/Microsoft/WinAppDriver">https://github.com/Microsoft/WinAppDriver</a></p>
</li>
<li><p>需要注意的是，要使用 WinAppDriver 服务框架完成 Windows 的自动化，需要满足 Windows10 或 Windows Server 2016 以上系统</p>
<p>另外，它支持的应用程序包含：</p>
<ul>
<li>UWP - Universal Windows Platform</li>
<li>WinForms  -  Windows Forms</li>
<li>WPF  -  Windows Presentation Foundation</li>
<li>Win32  -  Classic Windows</li>
</ul>
</li>
</ul>
<h3 id="应用检测"><a href="#应用检测" class="headerlink" title="应用检测"></a>应用检测</h3><ul>
<li>打开<a target="_blank" rel="noopener" href="https://accessibilityinsights.io/downloads/">Insights</a> 下载定位工具，检测是否能定位到元素</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20220927155045493.png" alt="image-20220927155045493"></p>
<ul>
<li>正常定位到元素</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20220927160349788.png" alt="image-20220927160349788"></p>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ul>
<li>开启「 开发者模式 」</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20220927160535821.png" alt="image-20220927160535821"></p>
<h3 id="下载WinAppDriver"><a href="#下载WinAppDriver" class="headerlink" title="下载WinAppDriver"></a>下载WinAppDriver</h3><ul>
<li>打开<a target="_blank" rel="noopener" href="https://github.com/Microsoft/WinAppDriver/releases">链接下载</a>，截至到现在最新版本为：<code>WindowsApplicationDriver-1.2.99-win-x86.exe</code></li>
<li>运行WinAppDriver.exe</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Windows Application Driver&gt;WinAppDriver.exe 4727</span><br><span class="line">Windows Application Driver listening for requests at: http://127.0.0.1:4727/</span><br><span class="line">Press ENTER to exit.</span><br></pre></td></tr></table></figure>

<h3 id="代码测试"><a href="#代码测试" class="headerlink" title="代码测试"></a>代码测试</h3><ul>
<li>安装selenium，<strong>不能用4的版本</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium==3.14.1</span><br></pre></td></tr></table></figure>

<ul>
<li>测试代码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleTests</span>(unittest.TestCase):</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUpClass</span>(<span class="params">self</span>):</span><br><span class="line">        desired_caps = &#123;&#125;</span><br><span class="line">        desired_caps[<span class="string">&#x27;app&#x27;</span>] = <span class="string">r&quot;C:\Windows\System32\notepad.exe&quot;</span></span><br><span class="line">        self.driver = webdriver.Remote(</span><br><span class="line">            command_executor=<span class="string">&#x27;http://127.0.0.1:4727&#x27;</span>,</span><br><span class="line">            desired_capabilities=desired_caps)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tearDownClass</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_edit</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.find_element_by_name(<span class="string">&quot;文本编辑器&quot;</span>).send_keys(<span class="string">&quot;helloword&quot;</span>)</span><br><span class="line">       </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    suite = unittest.TestLoader().loadTestsFromTestCase(SimpleTests)</span><br><span class="line">    unittest.TextTestRunner(verbosity=<span class="number">2</span>).run(suite)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>查看官网的<a target="_blank" rel="noopener" href="https://github.com/microsoft/WinAppDriver/blob/master/Samples/Python/calculatortest.py">测试代码</a></li>
</ul>
<h2 id="pywinauto"><a href="#pywinauto" class="headerlink" title="pywinauto"></a>pywinauto</h2><ul>
<li><p>主要使用到 <code>Application</code> 类，用于应用程序管理（打开与关闭应用等）、窗口管理（最小化、最大化、关闭窗口）</p>
</li>
<li><p>同时支持控件操作和图像操作，支持<code>Win32 API</code>和<code>MS UI Automation API</code></p>
</li>
<li><p>安装</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pywinauto</span><br></pre></td></tr></table></figure>

<h3 id="应用程序"><a href="#应用程序" class="headerlink" title="应用程序"></a>应用程序</h3><p>　确定应用程序的可访问技术，pywinauto的后端，支持控件的访问技术：</p>
<ul>
<li>Win32 API（backend&#x3D;”win32”）- 默认的backend，MFC，VB6，VCL。简单的WinForms控件和大多数旧的应用程序</li>
<li>MS UI Automation API ( backend &#x3D; “ uia “ )：WinForms , WPF , Store apps , Qt5 , 浏览器</li>
</ul>
<blockquote>
<p>注：可以借助于GUI对象检查工具来确定程序到底适用于那种backend。eg：如果使用 inspect 的uia模式，可见的控件和属性更多的话，backend可选uia，反之，backend可选win32。</p>
</blockquote>
<ul>
<li><p>常用的<a target="_blank" rel="noopener" href="https://github.com/blackrosezy/gui-inspect-tool">检查工具</a>：</p>
<ul>
<li><p>Inspect（定位元素工具（uia））</p>
</li>
<li><p>Spy++ （定位元素工具（win32））</p>
</li>
<li><p>UI Spy （定位元素工具）</p>
</li>
<li><p>Swapy（可简单生成pywinauto代码）</p>
</li>
</ul>
</li>
</ul>
<h3 id="定位元素"><a href="#定位元素" class="headerlink" title="定位元素"></a>定位元素</h3><ul>
<li>下载Inspect后，定位桌面微信</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20220930104310955.png" alt="image-20220930104310955"></p>
<ul>
<li>用UISpy定位，需要下载.net 3.5</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20220930105530130.png" alt="image-20220930105530130"></p>
<p><img src="/aposts/5639d3cc/image-20220930110003234.png" alt="image-20220930110003234"></p>
<ul>
<li>用SPYXX.EXE定位，拖动到Finder Tool图标到微信上，识别到后点击OK</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20220930110155030.png" alt="image-20220930110155030"></p>
<ul>
<li>看到当期微信的句柄等信息</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20220930110350697.png" alt="image-20220930110350697"></p>
<ul>
<li>打开并启动app</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from pywinauto.application import Application</span><br><span class="line">app = Application(backend = &quot;uia&quot;).start(r&#x27;C:\Program Files (x86)\Tencent\WeChat\WeChat.exe&#x27;) # 启动微信</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>连接app</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app = Application(backend=&#x27;uia&#x27;).connect(process=8948)  # 进程号</span><br><span class="line">app = Application().connect(handle=0x010f0c)  # 句柄</span><br><span class="line">app = Application().connect(path=&quot;D:\Office14\EXCEL.exe&quot;)  # path</span><br><span class="line">app = Application().connect(title_re=&quot;.*Notepad&quot;, class_name=“Notepad”) # 参数组合</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：<strong>应用程序必须先准备就绪，才能使用connect()，当应用程序start()后没有超时和重连的机制。在pywinauto外再启动应用程序，需要sleep，等程序start。</strong></p>
</blockquote>
<h3 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h3><h4 id="Application对象app的常用方法"><a href="#Application对象app的常用方法" class="headerlink" title="Application对象app的常用方法"></a>Application对象app的常用方法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">app.top_window() # 返回应用程序当前顶部窗口，是WindowSpecification对象，可以继续使用对象的方法往下继续查找控件</span><br><span class="line"># eg:如：app.top_window().child_window(title=&#x27;地址和搜索栏&#x27;, control_type=&#x27;Edit&#x27;)</span><br><span class="line"></span><br><span class="line">app.window(**kwargs) # 根据筛选条件，返回一个窗口， 是WindowSpecification对象，可以继续适用对象的方法往下继续查找控件</span><br><span class="line"># eg: 微信主界面 app.window(class_name=&#x27;WeChatMainWndForPC&#x27;)</span><br><span class="line"></span><br><span class="line">app.windows(**kwargs) # 根据筛选条件返回一个窗口列表，无条件默认全部，列表项为wrapped(装饰器)对象，可以使用wrapped对象的方法，注意不是WindowSpecification对象</span><br><span class="line"># eg：[&lt;uiawrapper.UIAWrapper - &#x27;李渝的早报 - Google Chrome&#x27;, Pane, -2064264099699444098&gt;]</span><br><span class="line"></span><br><span class="line">app.kill(soft=False) # 强制关闭</span><br><span class="line">app.cpu_usage() # 返回指定秒数期间的CPU使用率百分比</span><br><span class="line">app.wait_cpu_usage_lower(threshold=2.5, timeout=None, usage_interval=None) # 等待进程CPU使用率百分比小于指定的阈值threshold</span><br><span class="line">app.is64bit() # 如果操作的进程是64-bit，返回True</span><br></pre></td></tr></table></figure>

<h4 id="控件的定位和可用方法"><a href="#控件的定位和可用方法" class="headerlink" title="控件的定位和可用方法"></a>控件的定位和可用方法</h4><p><strong>层级查找控件的方法</strong>：定位控件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 通过层级查找控件相关方法</span><br><span class="line">window(**kwargs) # 用于窗口的查找</span><br><span class="line">child_window(**kwargs) # 可以无视层级的找后代中某个符合条件的元素===&gt;【最常用】</span><br><span class="line">parent() # 返回此元素的父元素,没有参数</span><br><span class="line">children(**kwargs) # 返回符合条件的子元素列表,支持索引，是BaseWrapper对象（或子类）</span><br><span class="line">iter_children(**kwargs) # 返回子元素的迭代器，是BaseWrapper对象（或子类）</span><br><span class="line">descendants(**kwargs) # 返回符合条件的所有后代元素列表,是BaseWrapper对象（或子类）</span><br><span class="line">iter_children(**kwargs) # 符合条件后代元素迭代器，是BaseWrapper对象（或子类）---&gt; 存疑，是iter_descendants？</span><br><span class="line"></span><br><span class="line">** kwargs的参数</span><br><span class="line"></span><br><span class="line"># 常用的</span><br><span class="line">class_name=None, # 类名</span><br><span class="line">class_name_re=None, # 正则匹配类名</span><br><span class="line">title=None, # 控件的标题文字，对应inspect中Name字段</span><br><span class="line">title_re=None, # 正则匹配文字</span><br><span class="line">control_type=None, # 控件类型，inspect界面LocalizedControlType字段的英文名</span><br><span class="line">best_match=None, # 模糊匹配类似的title</span><br><span class="line">auto_id=None, # inspect界面AutomationId字段，但是很多控件没有这个属性</span><br><span class="line"></span><br><span class="line"># 不常用</span><br><span class="line">parent=None,</span><br><span class="line">process=None,# 这个基本不用，每次启动进程都会变化</span><br><span class="line">top_level_only=True,</span><br><span class="line">visible_only=True,</span><br><span class="line">enabled_only=False,</span><br><span class="line">handle=None,</span><br><span class="line">ctrl_index=None,</span><br><span class="line">found_index=None,</span><br><span class="line">predicate_func=None,</span><br><span class="line">active_only=False,</span><br><span class="line">control_id=None,</span><br><span class="line">framework_id=None,</span><br><span class="line">backend=None,</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>控件可用的方法属性</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"># 以下几个只支持窗口模式的控件</span><br><span class="line">dlg.close() # 关闭界面</span><br><span class="line">dlg.minimize() # 最小化界面</span><br><span class="line">dlg.maximize() # 最大化界面</span><br><span class="line">dlg.restore() # 将窗口恢复为正常大小，比如最小化的让他正常显示在桌面</span><br><span class="line">dlg.get_show_state() # 正常0，最大化1，最小化2</span><br><span class="line">dlg.menu_select() # 菜单栏，eg：app.window.menu_select(Edit -&gt; Replace)</span><br><span class="line">dlg.exists(timeout=None, retry_interval=None) # 判断是否存在</span><br><span class="line">        #timeout：等待时间，一般默认5s</span><br><span class="line">        #retry_interval：timeout内重试时间</span><br><span class="line">dlg.wait(wait_for, timeout=None, retry_interval=None) # 等待窗口处于特定状态</span><br><span class="line">dlg.wait_not(wait_for_not, timeout=None, retry_interval=None) # 等待窗口不处于特定状态，即等待消失</span><br><span class="line">        # wait_for/wait_for_not:</span><br><span class="line">            # * &#x27;exists&#x27; means that the window is a valid handle</span><br><span class="line">            # * &#x27;visible&#x27; means that the window is not hidden</span><br><span class="line">            # * &#x27;enabled&#x27; means that the window is not disabled</span><br><span class="line">            # * &#x27;ready&#x27; means that the window is visible and enabled</span><br><span class="line">            # * &#x27;active&#x27; means that the window is active</span><br><span class="line">        # timeout:等待多久</span><br><span class="line">        # retry_interval:timeout内重试时间</span><br><span class="line">        # eg: dlg.wait(&#x27;ready&#x27;)</span><br><span class="line"></span><br><span class="line"># 鼠标键盘操作，只列举了常用形式，他们有很多默认参数但不常用，可以在源码中查看</span><br><span class="line">ctrl.click_input() # 最常用的点击方法，一切点击操作的基本方法（底层调用只是参数不同），左键单击，使用时一般都使用默认不需要带参数</span><br><span class="line">ctrl.right_click_input() # 鼠标右键单击</span><br><span class="line">ctrl.type_keys(keys, pause = None, with_spaces = False,) # 键盘输入,底层还是调用keyboard.send_keys</span><br><span class="line">        # keys：要输入的文字内容</span><br><span class="line">        # pause：每输入一个字符后等待时间，默认0.01就行</span><br><span class="line">        # with_spaces：是否保留keys中的所有空格，默认去除0</span><br><span class="line">ctrl.double_click_input(button =&quot;left&quot;, coords = (None, None)) # 左键双击</span><br><span class="line">ctrl.press_mouse_input(coords = (None, None)) # 指定坐标按下左键，不传坐标默认左上角</span><br><span class="line">ctrl.release_mouse_input(coords = (None, None)) # 指定坐标释放左键，不传坐标默认左上角</span><br><span class="line">ctrl.move_mouse_input(coords=(0, 0)) # 将鼠标移动到指定坐标，不传坐标默认左上角</span><br><span class="line">ctrl.drag_mouse_input(dst=(0, 0)) # 将ctrl拖动到dst,是press-move-release操作集合</span><br><span class="line"></span><br><span class="line"># 控件的常用属性</span><br><span class="line">ctrl.children_texts() # 所有子控件的文字列表，对应inspect中Name字段</span><br><span class="line">ctrl.window_text() # 控件的标题文字，对应inspect中Name字段</span><br><span class="line"># ctrl.element_info.name</span><br><span class="line">ctrl.class_name() # 控件的类名，对应inspect中ClassName字段，有些控件没有类名</span><br><span class="line"># ctrl.element_info.class_name</span><br><span class="line">ctrl.element_info.control_type # 控件类型，inspect界面LocalizedControlType字段的英文名</span><br><span class="line">ctrl.is_child(parent) # ctrl是否是parent的子控件</span><br><span class="line">ctrl.legacy_properties().get(&#x27;Value&#x27;) # 可以获取inspect界面LegacyIAccessible开头的一系列字段，在源码uiawraper.py中找到了这个方法，非常有用</span><br><span class="line"></span><br><span class="line"># 控件常用操作</span><br><span class="line">ctrl.draw_outline(colour=&#x27;green&#x27;) # 空间外围画框，便于查看，支持&#x27;red&#x27;, &#x27;green&#x27;, &#x27;blue&#x27;</span><br><span class="line">ctrl.print_control_identifiers(depth=None, filename=None) # 以树形结构打印其包含的元素，详见打印元素</span><br><span class="line">        # depth:打印的深度，缺省时打印最大深度。</span><br><span class="line">        # filename:将返回的标识存成文件（生成的文件与当前运行的脚本在同一个路径下）</span><br><span class="line">ctrl.scroll(direction, amount, count=1,) # 滚动</span><br><span class="line">        # direction ：&quot;up&quot;, &quot;down&quot;, &quot;left&quot;, &quot;right&quot;</span><br><span class="line">        # amount：&quot;line&quot; or &quot;page&quot;</span><br><span class="line">        # count：int 滚动次数</span><br><span class="line">ctrl.capture_as_image() # 返回控件的 PIL image对象，可继续使用其方法如下：</span><br><span class="line">        # eg: ctrl.capture_as_image().save(img_path)</span><br><span class="line">ret = ctrl.rectangle() # 控件上下左右坐标，(L430, T177, R1490, B941)，可输出上下左右</span><br><span class="line">        # eg: ret.top=177</span><br><span class="line">            # ret.bottom=941</span><br><span class="line">            # ret.left=430</span><br><span class="line">            # ret.right=1490</span><br></pre></td></tr></table></figure>

<h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><ul>
<li>用UISpy定位，记事本</li>
</ul>
<blockquote>
<p>不用微信演示，经过测试微信应该做了类似的屏蔽，很多内容获取不到，比如用打印当前窗口的所有controller（控件和属性）<code>win_main_Dialog.print_control_identifiers(depth=None, filename=None)</code>，报错了</p>
</blockquote>
<p><img src="/aposts/5639d3cc/image-20220930153132566.png" alt="image-20220930153132566"></p>
<ul>
<li>测试代码</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from pywinauto.application import Application</span><br><span class="line"># 启动记事本</span><br><span class="line">app = Application(backend = &quot;uia&quot;).start(r&#x27;notepad.exe&#x27;)</span><br><span class="line"># 找到记事本主窗口</span><br><span class="line">win = app.window(title_re=&quot;.*记事本*.&quot;)</span><br><span class="line">win.child_window(class_name=&quot;Edit&quot;).type_keys(&quot;hello&quot;)</span><br></pre></td></tr></table></figure>

<ul>
<li>还有一种方法是可以打印主窗口控件列表，然后你可以通过控件操作这个对象</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from pywinauto.application import Application</span><br><span class="line"># 启动记事本</span><br><span class="line">app = Application(backend = &quot;uia&quot;).start(r&#x27;notepad.exe&#x27;)</span><br><span class="line"># 找到记事本主窗口</span><br><span class="line">win = app.window(title_re=&quot;.*记事本*.&quot;)</span><br><span class="line">print(&#x27;-----------------&#x27;)</span><br><span class="line"># 打印主窗口控件列表，然后你可以通过控件id操作这个对象</span><br><span class="line">win.print_control_identifiers()</span><br></pre></td></tr></table></figure>

<ul>
<li>打印的值的格式大概如下</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Control Identifiers:</span><br><span class="line"></span><br><span class="line">Dialog - &#x27;无标题 - 记事本&#x27;    (L267, T123, R1707, B794)</span><br><span class="line">[&#x27;无标题 - 记事本Dialog&#x27;, &#x27;Dialog&#x27;, &#x27;无标题 - 记事本&#x27;]</span><br><span class="line">child_window(title=&quot;无标题 - 记事本&quot;, control_type=&quot;Window&quot;)</span><br><span class="line">   | </span><br><span class="line">   | Edit - &#x27;文本编辑器&#x27;    (L278, T198, R1696, B749)</span><br><span class="line">   | [&#x27;&#x27;, &#x27;Edit&#x27;, &#x27;0&#x27;, &#x27;1&#x27;]</span><br><span class="line">   | child_window(title=&quot;文本编辑器&quot;, auto_id=&quot;15&quot;, control_type=&quot;Edit&quot;)</span><br><span class="line">   |    | </span><br><span class="line">   | ...</span><br><span class="line">   | </span><br><span class="line">   | Menu - &#x27;应用程序&#x27;    (L278, T168, R1696, B197)</span><br><span class="line">   | [&#x27;应用程序Menu&#x27;, &#x27;应用程序&#x27;, &#x27;Menu2&#x27;]</span><br><span class="line">   | child_window(title=&quot;应用程序&quot;, auto_id=&quot;MenuBar&quot;, control_type=&quot;MenuBar&quot;)</span><br><span class="line">   |    | </span><br><span class="line">   |    | MenuItem - &#x27;文件(F)&#x27;    (L278, T168, R350, B197)</span><br><span class="line">   |    | [&#x27;文件(F)&#x27;, &#x27;MenuItem2&#x27;, &#x27;文件(F)MenuItem&#x27;]</span><br><span class="line">   |    | child_window(title=&quot;文件(F)&quot;, control_type=&quot;MenuItem&quot;)</span><br><span class="line">   |    | </span><br><span class="line">   |    | MenuItem - &#x27;编辑(E)&#x27;    (L350, T168, R422, B197)</span><br><span class="line">   |    | [&#x27;编辑(E)MenuItem&#x27;, &#x27;MenuItem3&#x27;, &#x27;编辑(E)&#x27;]</span><br><span class="line">   |    | child_window(title=&quot;编辑(E)&quot;, control_type=&quot;MenuItem&quot;)</span><br><span class="line">   |    | </span><br><span class="line">   |    | MenuItem - &#x27;格式(O)&#x27;    (L422, T168, R499, B197)</span><br><span class="line">   |    | [&#x27;MenuItem4&#x27;, &#x27;格式(O)MenuItem&#x27;, &#x27;格式(O)&#x27;]</span><br><span class="line">   |    | child_window(title=&quot;格式(O)&quot;, control_type=&quot;MenuItem&quot;)</span><br><span class="line">   |    | </span><br><span class="line">   |    | MenuItem - &#x27;查看(V)&#x27;    (L499, T168, R573, B197)</span><br><span class="line">   |    | [&#x27;MenuItem5&#x27;, &#x27;查看(V)MenuItem&#x27;, &#x27;查看(V)&#x27;]</span><br><span class="line">   |    | child_window(title=&quot;查看(V)&quot;, control_type=&quot;MenuItem&quot;)</span><br><span class="line">   |    | </span><br><span class="line">   |    | MenuItem - &#x27;帮助(H)&#x27;    (L573, T168, R649, B197)</span><br><span class="line">   |    | [&#x27;帮助(H)&#x27;, &#x27;帮助(H)MenuItem&#x27;, &#x27;MenuItem6&#x27;]</span><br><span class="line">   |    | child_window(title=&quot;帮助(H)&quot;, control_type=&quot;MenuItem&quot;)</span><br></pre></td></tr></table></figure>

<ul>
<li>调整后的代码为</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from pywinauto.application import Application</span><br><span class="line"># 启动记事本</span><br><span class="line">app = Application(backend = &quot;uia&quot;).start(r&#x27;notepad.exe&#x27;)</span><br><span class="line"># 找到记事本主窗口</span><br><span class="line">win = app.window(title_re=&quot;.*记事本*.&quot;)</span><br><span class="line">print(&#x27;-----------------&#x27;)</span><br><span class="line"># 打印主窗口控件列表</span><br><span class="line">win.print_control_identifiers()</span><br><span class="line"># win.child_window(class_name=&quot;Edit&quot;).type_keys(&quot;hello&quot;)</span><br><span class="line"># 操作对应窗口下面的组件</span><br><span class="line">win.Edit.type_keys(&#x27;hello&#x27;)</span><br><span class="line">win[&#x27;Edit&#x27;].type_keys(&#x27;world&#x27;)</span><br></pre></td></tr></table></figure>



<p><img src="/aposts/5639d3cc/image-20220930154435316.png" alt="image-20220930154435316"></p>
<ul>
<li>如果打印全部控件内容太多，也可以打印部分</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from pywinauto.application import Application</span><br><span class="line"># 启动记事本</span><br><span class="line">app = Application(backend = &quot;uia&quot;).start(r&#x27;notepad.exe&#x27;)</span><br><span class="line"># 找到记事本主窗口</span><br><span class="line">win = app.window(title_re=&quot;.*记事本*.&quot;)</span><br><span class="line">print(&#x27;-----------------&#x27;)</span><br><span class="line">dlg = win[&#x27;Edit&#x27;]</span><br><span class="line">dlg.print_control_identifiers()</span><br></pre></td></tr></table></figure>

<ul>
<li>对应打印的内容</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dit - &#x27;文本编辑器&#x27;    (L781, T200, R2199, B751)</span><br><span class="line">[&#x27;&#x27;, &#x27;Edit&#x27;]</span><br><span class="line">child_window(title=&quot;文本编辑器&quot;, auto_id=&quot;15&quot;, control_type=&quot;Edit&quot;)</span><br><span class="line">   | </span><br><span class="line">   | ScrollBar - &#x27;垂直滚动条&#x27;    (L2173, T200, R2199, B751)</span><br><span class="line">   | [&#x27;垂直滚动条&#x27;, &#x27;垂直滚动条ScrollBar&#x27;, &#x27;ScrollBar&#x27;]</span><br><span class="line">   | child_window(title=&quot;垂直滚动条&quot;, auto_id=&quot;NonClientVerticalScrollBar&quot;, control_type=&quot;ScrollBar&quot;)</span><br><span class="line">   |    | </span><br><span class="line">   |    | Button - &#x27;上一行&#x27;    (L2173, T200, R2199, B226)</span><br><span class="line">   |    | [&#x27;上一行Button&#x27;, &#x27;Button&#x27;, &#x27;上一行&#x27;, &#x27;Button0&#x27;, &#x27;Button1&#x27;]</span><br><span class="line">   |    | child_window(title=&quot;上一行&quot;, auto_id=&quot;UpButton&quot;, control_type=&quot;Button&quot;)</span><br><span class="line">   |    | </span><br><span class="line">   |    | Button - &#x27;下一行&#x27;    (L2173, T725, R2199, B751)</span><br><span class="line">   |    | [&#x27;下一行&#x27;, &#x27;下一行Button&#x27;, &#x27;Button2&#x27;]</span><br><span class="line">   |    | child_window(title=&quot;下一行&quot;, auto_id=&quot;DownButton&quot;, control_type=&quot;Button&quot;)</span><br></pre></td></tr></table></figure>

<ul>
<li>两者结合使用</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pywinauto.application <span class="keyword">import</span> Application</span><br><span class="line"><span class="comment"># 启动记事本</span></span><br><span class="line">app = Application(backend = <span class="string">&quot;uia&quot;</span>).start(<span class="string">r&#x27;notepad.exe&#x27;</span>)</span><br><span class="line"><span class="comment"># 找到记事本主窗口</span></span><br><span class="line">win = app.window(title_re=<span class="string">&quot;.*记事本*.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-----------------&#x27;</span>)</span><br><span class="line"><span class="comment"># 打印主窗口控件列表</span></span><br><span class="line"><span class="comment"># win.print_control_identifiers()</span></span><br><span class="line"><span class="comment"># 记事本中输入内容</span></span><br><span class="line">win.child_window(class_name=<span class="string">&quot;Edit&quot;</span>).type_keys(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line"><span class="comment"># 选择菜单另存为</span></span><br><span class="line">win.menu_select(<span class="string">&quot;文件-&gt;另存为&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 定位另存为窗口的输入框，并且输入内容；注意这里有三层，一层层往下面找</span></span><br><span class="line">win.child_window(class_name=<span class="string">&#x27;DUIViewWndClassName&#x27;</span>, control_type=<span class="string">&#x27;Pane&#x27;</span>).\</span><br><span class="line">    child_window(class_name=<span class="string">&#x27;AppControlHost&#x27;</span>,control_type=<span class="string">&#x27;ComboBox&#x27;</span>, auto_id=<span class="string">&#x27;FileNameControlHost&#x27;</span>).\</span><br><span class="line">    child_window(class_name=<span class="string">&#x27;Edit&#x27;</span>).type_keys(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"><span class="comment"># 点击保存</span></span><br><span class="line">win[<span class="string">u&quot;保存&quot;</span>].click_input()</span><br></pre></td></tr></table></figure>

<p><img src="/aposts/5639d3cc/image-20220930165315916.png" alt="image-20220930165315916"></p>
<ul>
<li>优化下代码</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line">from pywinauto.application import Application</span><br><span class="line"></span><br><span class="line">def driver():</span><br><span class="line">    app = Application(backend=&quot;uia&quot;).start(r&quot;notepad.exe&quot;)</span><br><span class="line">    return app</span><br><span class="line"></span><br><span class="line">def test():</span><br><span class="line">    # 启动记事本</span><br><span class="line">    app = driver()</span><br><span class="line">    # 找到记事本主窗口</span><br><span class="line">    win = app.window(title_re=&quot;.*记事本*.&quot;)</span><br><span class="line">    print(&#x27;-----------------&#x27;)</span><br><span class="line">    # 打印主窗口控件列表</span><br><span class="line">    # win.print_control_identifiers()</span><br><span class="line">    # 记事本中输入内容</span><br><span class="line">    win.Edit.type_keys(&quot;hello&quot;)</span><br><span class="line">    # 选择菜单另存为</span><br><span class="line">    win.menu_select(&quot;文件-&gt;另存为&quot;)</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    # 定位另存为窗口的输入框，并且输入内容；注意这里有三层，一层层往下面找</span><br><span class="line">    win.child_window(class_name=&#x27;DUIViewWndClassName&#x27;, control_type=&#x27;Pane&#x27;).\</span><br><span class="line">        child_window(class_name=&#x27;AppControlHost&#x27;,control_type=&#x27;ComboBox&#x27;, auto_id=&#x27;FileNameControlHost&#x27;).\</span><br><span class="line">        child_window(class_name=&#x27;Edit&#x27;).type_keys(&#x27;hello&#x27;)</span><br><span class="line">    # 点击保存</span><br><span class="line">    win[u&quot;保存&quot;].click_input()</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    # 关闭窗口</span><br><span class="line">    win.close()</span><br><span class="line"></span><br><span class="line">test()</span><br></pre></td></tr></table></figure>



<ul>
<li>更多api参考这个<a target="_blank" rel="noopener" href="https://www.kancloud.cn/gnefnuy/pywinauto_doc/1193035">文档</a></li>
</ul>
<h2 id="pywin32"><a href="#pywin32" class="headerlink" title="pywin32"></a>pywin32</h2><ul>
<li>pywin32 包含 win32gui、win32api、win32con 3个子模块，主要用于窗口管理（定位窗口、显示和关闭窗口、窗口前置、窗口聚焦、获取窗口位置等），通常用的较多的是 win32gui，因此本文仅对此子模块进行介绍</li>
<li>安装</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pywin32</span><br></pre></td></tr></table></figure>

<ul>
<li>常用的事件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#查找窗口句柄</span><br><span class="line">win32gui.FindWindow()</span><br><span class="line">#查找指定窗口的菜单</span><br><span class="line">win32gui.GetMenu()</span><br><span class="line">#查找某个菜单的子菜单</span><br><span class="line">win32gui.GetSubMenu()</span><br><span class="line">#获得子菜单的ID</span><br><span class="line">win32gui.GetMenuItemID()</span><br><span class="line">#获得某个子菜单的内容</span><br><span class="line">win32gui.GetMenuItemInfo()</span><br><span class="line">#给句柄发送通知（点击事件）</span><br><span class="line">win32gui.PostMessage()　</span><br></pre></td></tr></table></figure>

<ul>
<li>实例代码打开记事本，点击文件另存为</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import win32gui, win32con, win32api</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"># 打开记事本</span><br><span class="line">win32api.ShellExecute(0,&quot;open&quot;,&quot;notepad.exe&quot;,&quot;&quot;,&quot;&quot;,1)</span><br><span class="line"></span><br><span class="line"># 等待记事本窗口打开</span><br><span class="line">time.sleep(1)</span><br><span class="line"></span><br><span class="line"># 寻找记事本窗口</span><br><span class="line">notepad = win32gui.FindWindow(&quot;Notepad&quot;, None)</span><br><span class="line"></span><br><span class="line"># 若为非 0 的值，代表有找到窗口</span><br><span class="line">if (notepad != 0):</span><br><span class="line"></span><br><span class="line">    # 设置记事本标题</span><br><span class="line">    win32gui.SendMessage(notepad, win32con.WM_SETTEXT, None, &quot;Hello&quot;)</span><br><span class="line"></span><br><span class="line">    # 寻找输入文字的地方</span><br><span class="line">    edit = win32gui.FindWindowEx(notepad, None, &quot;Edit&quot;, None)</span><br><span class="line"></span><br><span class="line">    # 输入文字</span><br><span class="line">    win32gui.SendMessage(edit, win32con.WM_SETTEXT, None, &quot;您好！Pythonn&quot;)</span><br><span class="line">    # 插入一个回车</span><br><span class="line">    win32gui.PostMessage(edit, win32con.WM_KEYDOWN, win32con.VK_RETURN, 0)</span><br><span class="line"></span><br><span class="line">    menu_handle = win32gui.GetMenu(notepad)</span><br><span class="line">    # 这里的代码分块逻辑，搞不明白</span><br><span class="line">    for index in [0,3]:</span><br><span class="line">        cmd_ID = win32gui.GetMenuItemID(menu_handle, 3)</span><br><span class="line">        menu_handle = win32gui.GetSubMenu(menu_handle, 0)</span><br><span class="line"></span><br><span class="line">    # 点击另存为</span><br><span class="line">    win32gui.PostMessage(notepad, win32con.WM_COMMAND, cmd_ID, 0)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>代码来做<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33833073/article/details/104011895">这里</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/LyShark/p/12538209.html">更多参考</a></li>
</ul>
<p><strong>放弃对这个模块的研究，写用例非常累</strong></p>
<h2 id="pyautogui"><a href="#pyautogui" class="headerlink" title="pyautogui"></a>pyautogui</h2><ul>
<li>pyautogui 模块主要用于屏幕控制（获取屏幕尺寸、截屏等）、鼠标控制（移动鼠标、单击、双击、右击、拖拽、滚动等）、键盘控制（编辑、按键等）</li>
<li>主要是<strong>图片识别</strong></li>
</ul>
<p><strong>几个特有功能</strong></p>
<ul>
<li><strong>移动鼠标</strong>并在其他应用程序的窗口中<strong>单击</strong>。</li>
<li>向应用程序发送击键（例如，填写表单）。</li>
<li>截取屏幕<strong>截图</strong>，并给出一个图像（例如，按钮或复选框的图像），然后在屏幕上找到它。</li>
<li>找到应用程序的窗口，然后移动、调整大小、最大化、最小化或关闭它（目前仅限 Windows）。</li>
<li>显示警报和消息框。</li>
</ul>
<h3 id="前置参数"><a href="#前置参数" class="headerlink" title="前置参数"></a>前置参数</h3><ul>
<li><strong>来自于<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b4345e676c34">这里</a></strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui </span><br><span class="line"><span class="comment"># 停顿功能 </span></span><br><span class="line">pyautogui.PAUSE = <span class="number">1</span> <span class="comment"># 调用在执行动作后暂停的秒数，只能在执行一些pyautogui动作后才能使用，建议用time.sleep</span></span><br><span class="line"><span class="comment"># 自动 防故障功能</span></span><br><span class="line">pyautogui.FAILSAFE = <span class="literal">True</span> <span class="comment"># 启用自动防故障功能，左上角的坐标为（0，0），将鼠标移到屏幕的左上角，来抛出failSafeException异常</span></span><br></pre></td></tr></table></figure>

<h3 id="鼠标操作"><a href="#鼠标操作" class="headerlink" title="鼠标操作"></a>鼠标操作</h3><h4 id="获取屏幕的宽度和高度"><a href="#获取屏幕的宽度和高度" class="headerlink" title="获取屏幕的宽度和高度"></a>获取屏幕的宽度和高度</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">width, height = pyautogui.size() <span class="comment"># 获取屏幕的宽度和高度</span></span><br><span class="line"><span class="built_in">print</span>(width, height)</span><br></pre></td></tr></table></figure>

<h4 id="获取鼠标当前位置"><a href="#获取鼠标当前位置" class="headerlink" title="获取鼠标当前位置"></a>获取鼠标当前位置</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">currentMouseX, currentMouseY = pyautogui.position() <span class="comment"># 鼠标当前位置</span></span><br><span class="line"><span class="built_in">print</span>(currentMouseX, currentMouseY)</span><br></pre></td></tr></table></figure>

<h4 id="鼠标移动类操作"><a href="#鼠标移动类操作" class="headerlink" title="鼠标移动类操作"></a>鼠标移动类操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pyautogui.moveTo(x,y,持续时间) 在持续时间内 将光标移动到目标位置(x,y)</span></span><br><span class="line">pyautogui.moveTo(<span class="number">100</span>, <span class="number">100</span>, duration=<span class="number">0.25</span>) <span class="comment"># 移动到 (100,100)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pyautogui.moveRel(xOffset,yxOffset,持续时间) 在持续时间内 将光标偏移 距离原始位置 xOffset,yxOffset 的位置</span></span><br><span class="line">pyautogui.moveRel(<span class="number">50</span>, <span class="number">0</span>, duration=<span class="number">0.25</span>) <span class="comment"># 从当前位置右移50像素</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 实现拖拽效果</span></span><br><span class="line">pyautogui.mouseDown(<span class="number">740</span>,<span class="number">73</span>)  <span class="comment">#鼠标按下指定位置</span></span><br><span class="line">pyautogui.moveRel(<span class="number">100</span>,<span class="number">0</span>,<span class="number">2</span>)  <span class="comment">#移动/可以使用其他移动方法</span></span><br><span class="line">pyautogui.mouseUp()     <span class="comment"># 鼠标抬起</span></span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">pyautogui.dragTo(<span class="number">100</span>,<span class="number">300</span>,duration=<span class="number">1</span>)   </span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">pyautogui.dragRel(<span class="number">100</span>,<span class="number">300</span>,duration=<span class="number">4</span>) </span><br></pre></td></tr></table></figure>

<h4 id="鼠标滚动类操作"><a href="#鼠标滚动类操作" class="headerlink" title="鼠标滚动类操作"></a>鼠标滚动类操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># scroll函数控制鼠标滚轮的滚动，amount_to_scroll参数表示滚动的格数。正数则页面向上滚动，负数则向下滚动</span></span><br><span class="line"><span class="comment"># pyautogui.scroll(clicks=amount_to_scroll, x=moveToX, y=moveToY)</span></span><br><span class="line"><span class="comment"># 默认从当前光标位置进行滑动  amount_to_scroll是个数字 数字太小效果可能不明显, 正数表示往上划 负数表示往下化</span></span><br><span class="line">pyautogui.scroll(<span class="number">500</span>, <span class="number">20</span>, <span class="number">2</span>)</span><br><span class="line">pyautogui.scroll(<span class="number">100</span>) <span class="comment"># 向上滚动100格</span></span><br><span class="line">pyautogui.scroll(-<span class="number">100</span>) <span class="comment"># 向下滚动100格</span></span><br><span class="line">pyautogui.scroll(<span class="number">100</span>, x=<span class="number">100</span>, y=<span class="number">100</span>) <span class="comment"># 移动到(100, 100)位置再向上滚动100格</span></span><br></pre></td></tr></table></figure>

<h4 id="鼠标点击类操作"><a href="#鼠标点击类操作" class="headerlink" title="鼠标点击类操作"></a>鼠标点击类操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pyautogui.click(x,y,clicks=点击次数,interval=每次点击间隔频率,button=可以是left表示左击 可以是right表示右击 可以是middle表示中击)</span></span><br><span class="line">pyautogui.click(<span class="number">10</span>, <span class="number">20</span>, <span class="number">2</span>, <span class="number">0.25</span>, button=<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line">pyautogui.click(x=<span class="number">100</span>, y=<span class="number">200</span>, duration=<span class="number">2</span>) <span class="comment"># 先移动到(100, 200)再单击</span></span><br><span class="line">pyautogui.click() <span class="comment"># 鼠标当前位置点击一下</span></span><br><span class="line">pyautogui.doubleClick() <span class="comment"># 鼠标当前位置左击两下</span></span><br><span class="line">pyautogui.doubleClick(x=<span class="number">100</span>, y=<span class="number">150</span>, button=<span class="string">&quot;left&quot;</span>) <span class="comment"># 鼠标在（100，150）位置左击两下</span></span><br><span class="line">pyautogui.tripleClick() <span class="comment"># 鼠标当前位置左击三下</span></span><br><span class="line">pyautogui.rightClick(<span class="number">10</span>,<span class="number">10</span>)   <span class="comment"># 指定位置，双击右键</span></span><br><span class="line">pyautogui.middleClick(<span class="number">10</span>,<span class="number">10</span>)  <span class="comment"># 指定位置，双击中键</span></span><br></pre></td></tr></table></figure>

<h3 id="键盘操作"><a href="#键盘操作" class="headerlink" title="键盘操作"></a>键盘操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 相关操作</span></span><br><span class="line"><span class="comment"># pyautogui.typewrite(要输入的字符只能是英文,interval=输入每个字符的间隔频率)</span></span><br><span class="line">pyautogui.typewrite(<span class="string">&#x27;python&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># typewrite 还可以传入单字母的列表</span></span><br><span class="line"><span class="comment"># 运行下面代码，编辑器里面就会输出 python 之后换行。</span></span><br><span class="line">pyautogui.typewrite([<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;enter&#x27;</span>])   </span><br><span class="line"></span><br><span class="line"><span class="comment"># pyautogui.keyDown()：模拟按键按下</span></span><br><span class="line"><span class="comment"># pyautogui.keyUP()：模拟按键松开</span></span><br><span class="line"><span class="comment"># pyautogui.press(键盘按键字母)  模拟一次按键过程，即 keyDown 和 keyUP 的组合 按下指定的键盘按键</span></span><br><span class="line"><span class="comment"># pyautogui.hotkey(&quot;ctrl&quot;,&quot;a&quot;)  实现组合键功能</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按住 shift 按键，然后再按住 1 按键，就可以了。用 pyautogui 控制就是</span></span><br><span class="line">pyautogui.keyDown(<span class="string">&#x27;shift&#x27;</span>)    </span><br><span class="line">pyautogui.press(<span class="string">&#x27;1&#x27;</span>)    </span><br><span class="line">pyautogui.keyUp(<span class="string">&#x27;shift&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入中文字符的方法  借用 pyperclip模块</span></span><br><span class="line"><span class="keyword">import</span> pyperclip</span><br><span class="line">pyperclip.copy(<span class="string">&quot;要书写的字符串&quot;</span>)  <span class="comment">#复制字符串</span></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">pyautogui.hotkey(<span class="string">&quot;ctrl&quot;</span>,<span class="string">&quot;v&quot;</span>) <span class="comment">#实现复制</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># pyautogui.KEYBOARD_KEYS数组中就是press()，keyDown()，keyUp()和hotkey()函数可以输入的按键名称</span></span><br><span class="line">pyautogui.KEYBOARD_KEYS = [<span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;.&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;@&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&#x27;~&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;accept&#x27;</span>, <span class="string">&#x27;add&#x27;</span>, <span class="string">&#x27;alt&#x27;</span>, <span class="string">&#x27;altleft&#x27;</span>, <span class="string">&#x27;altright&#x27;</span>, <span class="string">&#x27;apps&#x27;</span>, <span class="string">&#x27;backspace&#x27;</span>, <span class="string">&#x27;browserback&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;browserfavorites&#x27;</span>, <span class="string">&#x27;browserforward&#x27;</span>, <span class="string">&#x27;browserhome&#x27;</span>, <span class="string">&#x27;browserrefresh&#x27;</span>, <span class="string">&#x27;browsersearch&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;browserstop&#x27;</span>, <span class="string">&#x27;capslock&#x27;</span>, <span class="string">&#x27;clear&#x27;</span>, <span class="string">&#x27;convert&#x27;</span>, <span class="string">&#x27;ctrl&#x27;</span>, <span class="string">&#x27;ctrlleft&#x27;</span>, <span class="string">&#x27;ctrlright&#x27;</span>, <span class="string">&#x27;decimal&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;del&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;divide&#x27;</span>, <span class="string">&#x27;down&#x27;</span>, <span class="string">&#x27;end&#x27;</span>, <span class="string">&#x27;enter&#x27;</span>, <span class="string">&#x27;esc&#x27;</span>, <span class="string">&#x27;escape&#x27;</span>, <span class="string">&#x27;execute&#x27;</span>, <span class="string">&#x27;f1&#x27;</span>, <span class="string">&#x27;f10&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;f11&#x27;</span>, <span class="string">&#x27;f12&#x27;</span>, <span class="string">&#x27;f13&#x27;</span>, <span class="string">&#x27;f14&#x27;</span>, <span class="string">&#x27;f15&#x27;</span>, <span class="string">&#x27;f16&#x27;</span>, <span class="string">&#x27;f17&#x27;</span>, <span class="string">&#x27;f18&#x27;</span>, <span class="string">&#x27;f19&#x27;</span>, <span class="string">&#x27;f2&#x27;</span>, <span class="string">&#x27;f20&#x27;</span>, <span class="string">&#x27;f21&#x27;</span>, <span class="string">&#x27;f22&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;f23&#x27;</span>, <span class="string">&#x27;f24&#x27;</span>, <span class="string">&#x27;f3&#x27;</span>, <span class="string">&#x27;f4&#x27;</span>, <span class="string">&#x27;f5&#x27;</span>, <span class="string">&#x27;f6&#x27;</span>, <span class="string">&#x27;f7&#x27;</span>, <span class="string">&#x27;f8&#x27;</span>, <span class="string">&#x27;f9&#x27;</span>, <span class="string">&#x27;final&#x27;</span>, <span class="string">&#x27;fn&#x27;</span>, <span class="string">&#x27;hanguel&#x27;</span>, <span class="string">&#x27;hangul&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;hanja&#x27;</span>, <span class="string">&#x27;help&#x27;</span>, <span class="string">&#x27;home&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;junja&#x27;</span>, <span class="string">&#x27;kana&#x27;</span>, <span class="string">&#x27;kanji&#x27;</span>, <span class="string">&#x27;launchapp1&#x27;</span>, <span class="string">&#x27;launchapp2&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;launchmail&#x27;</span>, <span class="string">&#x27;launchmediaselect&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, <span class="string">&#x27;modechange&#x27;</span>, <span class="string">&#x27;multiply&#x27;</span>, <span class="string">&#x27;nexttrack&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;nonconvert&#x27;</span>, <span class="string">&#x27;num0&#x27;</span>, <span class="string">&#x27;num1&#x27;</span>, <span class="string">&#x27;num2&#x27;</span>, <span class="string">&#x27;num3&#x27;</span>, <span class="string">&#x27;num4&#x27;</span>, <span class="string">&#x27;num5&#x27;</span>, <span class="string">&#x27;num6&#x27;</span>, <span class="string">&#x27;num7&#x27;</span>, <span class="string">&#x27;num8&#x27;</span>, <span class="string">&#x27;num9&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;numlock&#x27;</span>, <span class="string">&#x27;pagedown&#x27;</span>, <span class="string">&#x27;pageup&#x27;</span>, <span class="string">&#x27;pause&#x27;</span>, <span class="string">&#x27;pgdn&#x27;</span>, <span class="string">&#x27;pgup&#x27;</span>, <span class="string">&#x27;playpause&#x27;</span>, <span class="string">&#x27;prevtrack&#x27;</span>, <span class="string">&#x27;print&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;printscreen&#x27;</span>, <span class="string">&#x27;prntscrn&#x27;</span>, <span class="string">&#x27;prtsc&#x27;</span>, <span class="string">&#x27;prtscr&#x27;</span>, <span class="string">&#x27;return&#x27;</span>, <span class="string">&#x27;right&#x27;</span>, <span class="string">&#x27;scrolllock&#x27;</span>, <span class="string">&#x27;select&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;separator&#x27;</span>, <span class="string">&#x27;shift&#x27;</span>, <span class="string">&#x27;shiftleft&#x27;</span>, <span class="string">&#x27;shiftright&#x27;</span>, <span class="string">&#x27;sleep&#x27;</span>, <span class="string">&#x27;space&#x27;</span>, <span class="string">&#x27;stop&#x27;</span>, <span class="string">&#x27;subtract&#x27;</span>, <span class="string">&#x27;tab&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;up&#x27;</span>, <span class="string">&#x27;volumedown&#x27;</span>, <span class="string">&#x27;volumemute&#x27;</span>, <span class="string">&#x27;volumeup&#x27;</span>, <span class="string">&#x27;win&#x27;</span>, <span class="string">&#x27;winleft&#x27;</span>, <span class="string">&#x27;winright&#x27;</span>, <span class="string">&#x27;yen&#x27;</span>, <span class="string">&#x27;command&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;option&#x27;</span>, <span class="string">&#x27;optionleft&#x27;</span>, <span class="string">&#x27;optionright&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="弹窗操作"><a href="#弹窗操作" class="headerlink" title="弹窗操作"></a>弹窗操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 显示一个简单的带文字和OK按钮的消息弹窗。用户点击后返回button的文字。</span></span><br><span class="line">pyautogui.alert(text=<span class="string">&#x27;&#x27;</span>, title=<span class="string">&#x27;&#x27;</span>, button=<span class="string">&#x27;OK&#x27;</span>)</span><br><span class="line">b = pyautogui.alert(text=<span class="string">&#x27;要开始程序么？&#x27;</span>, title=<span class="string">&#x27;请求框&#x27;</span>, button=<span class="string">&#x27;OK&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment"># 输出结果为OK</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 显示一个简单的带文字、OK和Cancel按钮的消息弹窗，用户点击后返回被点击button的文字，支持自定义数字、文字的列表。</span></span><br><span class="line">pyautogui.confirm(text=<span class="string">&#x27;&#x27;</span>, title=<span class="string">&#x27;&#x27;</span>, buttons=[<span class="string">&#x27;OK&#x27;</span>, <span class="string">&#x27;Cancel&#x27;</span>]) <span class="comment"># OK和Cancel按钮的消息弹窗</span></span><br><span class="line">pyautogui.confirm(text=<span class="string">&#x27;&#x27;</span>, title=<span class="string">&#x27;&#x27;</span>, buttons=<span class="built_in">range</span>(<span class="number">10</span>)) <span class="comment"># 10个按键0-9的消息弹窗</span></span><br><span class="line">a = pyautogui.confirm(text=<span class="string">&#x27;&#x27;</span>, title=<span class="string">&#x27;&#x27;</span>, buttons=<span class="built_in">range</span>(<span class="number">10</span>))</span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># 输出结果为你选的数字</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 可以输入的消息弹窗，带OK和Cancel按钮。用户点击OK按钮返回输入的文字，点击Cancel按钮返回None。</span></span><br><span class="line">pyautogui.prompt(text=<span class="string">&#x27;&#x27;</span>, title=<span class="string">&#x27;&#x27;</span>, default=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 样式同prompt()，用于输入密码，消息用*表示。带OK和Cancel按钮。用户点击OK按钮返回输入的文字，点击Cancel按钮返回None。</span></span><br><span class="line">pyautogui.password(text=<span class="string">&#x27;&#x27;</span>, title=<span class="string">&#x27;&#x27;</span>, default=<span class="string">&#x27;&#x27;</span>, mask=<span class="string">&#x27;*&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="图像操作"><a href="#图像操作" class="headerlink" title="图像操作"></a>图像操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line">im = pyautogui.screenshot() <span class="comment"># 返回屏幕的截图，是一个Pillow的image对象</span></span><br><span class="line">im.save(<span class="string">&#x27;屏幕截图.png&#x27;</span>) <span class="comment">#保存图片</span></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">im = pyautogui.screenshot(<span class="string">&#x27;屏幕截图.png&#x27;</span>) <span class="comment"># 截全屏并设置保存图片的位置和名称</span></span><br><span class="line"><span class="built_in">print</span>(im) <span class="comment"># 打印图片的属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不截全屏，截取区域图片。截取区域region参数为：左上角XY坐标值、宽度和高度</span></span><br><span class="line">pyautogui.screenshot(<span class="string">&#x27;屏幕截图.png&#x27;</span>, region=(<span class="number">0</span>, <span class="number">0</span>, <span class="number">300</span>, <span class="number">400</span>))</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得文件图片在现在的屏幕上面的坐标，返回的是一个元组(top, left, width, height)</span></span><br><span class="line"><span class="comment"># 如果截图没找到，pyautogui.locateOnScreen()函数返回None</span></span><br><span class="line">a = pyautogui.locateOnScreen(<span class="string">r&#x27;目标图片路径&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># 打印结果为Box(left=0, top=0, width=300, height=400)</span></span><br><span class="line">x, y = pyautogui.center(a) <span class="comment"># 获得文件图片在现在的屏幕上面的中心坐标</span></span><br><span class="line"><span class="built_in">print</span>(x, y) <span class="comment"># 打印结果为150 200</span></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">x, y = pyautogui.locateCenterOnScreen(<span class="string">r&#x27;目标图片路径&#x27;</span>) <span class="comment"># 这步与上面的四行代码作用一样</span></span><br><span class="line"><span class="built_in">print</span>(x, y) <span class="comment"># 打印结果为150 200</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 匹配屏幕所有与目标图片的对象，可以用for循环和list()输出</span></span><br><span class="line"><span class="keyword">for</span> pos <span class="keyword">in</span> pyautogui.locateAllOnScreen(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\region_screenshot.png&#x27;</span>):</span><br><span class="line">  <span class="built_in">print</span>(pos)</span><br><span class="line"><span class="comment"># 打印结果为Box(left=0, top=0, width=300, height=400)</span></span><br><span class="line">a = <span class="built_in">list</span>(pyautogui.locateAllOnScreen(<span class="string">r&#x27;C:\Users\ZDH\Desktop\PY\region_screenshot.png&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># 打印结果为[Box(left=0, top=0, width=300, height=400)]</span></span><br></pre></td></tr></table></figure>

<h3 id="分辨率适配"><a href="#分辨率适配" class="headerlink" title="分辨率适配"></a>分辨率适配</h3><p>注意:pyautogui的图像识别是模板匹配算法 无法跨分辨率识别(图片放大缩小就无法识别) 提供以下图像识别算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">使用需求:</span></span><br><span class="line"><span class="string">    需要安装 airtest  pip install  airtest  -i https://mirrors.aliyun.com/pypi/simple/</span></span><br><span class="line"><span class="string">    运行时如果出现以下错误:  </span></span><br><span class="line"><span class="string">            import win32api</span></span><br><span class="line"><span class="string">        ImportError: DLL load failed: 找不到指定的程序。</span></span><br><span class="line"><span class="string">    重新安装win32api版本</span></span><br><span class="line"><span class="string">        pip install pywin32==227   # 安装 227版本</span></span><br><span class="line"><span class="string">        不行的话再试试</span></span><br><span class="line"><span class="string">        pip install pywin32==223  # 安装 223版本</span></span><br><span class="line"><span class="string">       </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> types</span><br><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="keyword">from</span> airtest <span class="keyword">import</span> aircv</span><br><span class="line"><span class="keyword">from</span> airtest.aircv <span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> airtest.aircv.template_matching <span class="keyword">import</span> TemplateMatching</span><br><span class="line"><span class="keyword">from</span> airtest.core.cv <span class="keyword">import</span> MATCHING_METHODS, Predictor</span><br><span class="line"><span class="keyword">from</span> airtest.core.error <span class="keyword">import</span> InvalidMatchingMethodError</span><br><span class="line"><span class="keyword">from</span> airtest.core.helper <span class="keyword">import</span> logwrap, G</span><br><span class="line"><span class="keyword">from</span> airtest.core.win.screen <span class="keyword">import</span> screenshot</span><br><span class="line"><span class="keyword">from</span> airtest.utils.transform <span class="keyword">import</span> TargetPos</span><br><span class="line"><span class="keyword">from</span> six <span class="keyword">import</span> PY3</span><br><span class="line"><span class="keyword">from</span> airtest.core.settings <span class="keyword">import</span> Settings <span class="keyword">as</span> ST  <span class="comment"># noqa</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # -*- encoding=utf8 -*-</span></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logger = logging.getLogger(<span class="string">&quot;airtest&quot;</span>)</span><br><span class="line">logger.setLevel(logging.ERROR)</span><br><span class="line"><span class="comment"># 日志级别有[DEBUG]、[INFO]、[WARNING] 和 [ERROR]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Template</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    picture as touch/swipe/wait/exists target and extra info for cv match</span></span><br><span class="line"><span class="string">    filename: pic filename</span></span><br><span class="line"><span class="string">    target_pos: ret which pos in the pic</span></span><br><span class="line"><span class="string">    record_pos: pos in screen when recording</span></span><br><span class="line"><span class="string">    resolution: screen resolution when recording</span></span><br><span class="line"><span class="string">    rgb: 识别结果是否使用rgb三通道进行校验.</span></span><br><span class="line"><span class="string">    scale_max: 多尺度模板匹配最大范围.</span></span><br><span class="line"><span class="string">    scale_step: 多尺度模板匹配搜索步长.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, filename, threshold=<span class="literal">None</span>, target_pos=TargetPos.MID, record_pos=<span class="literal">None</span>, resolution=(<span class="params"></span>), rgb=<span class="literal">False</span>, scale_max=<span class="number">800</span>, scale_step=<span class="number">0.005</span></span>):</span><br><span class="line">        self.filename = filename</span><br><span class="line">        <span class="comment"># self.filename =os.path.join(Settings.Picture_Path,filename)</span></span><br><span class="line">        self._filepath = <span class="literal">None</span></span><br><span class="line">        self.threshold = threshold <span class="keyword">or</span> ST.THRESHOLD</span><br><span class="line">        self.target_pos = target_pos</span><br><span class="line">        self.record_pos = record_pos</span><br><span class="line">        self.resolution = resolution</span><br><span class="line">        self.rgb = rgb</span><br><span class="line">        self.scale_max = scale_max</span><br><span class="line">        self.scale_step = scale_step</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">filepath</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.filename</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        filepath = self.filepath <span class="keyword">if</span> PY3 <span class="keyword">else</span> self.filepath.encode(sys.getfilesystemencoding())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Template(%s)&quot;</span> % filepath</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">match_in</span>(<span class="params">self, screen</span>):</span><br><span class="line">        match_result = self._cv_match(screen)</span><br><span class="line">        G.LOGGING.debug(<span class="string">&quot;match result: %s&quot;</span>, match_result)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> match_result:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        focus_pos = TargetPos().getXY(match_result, self.target_pos)</span><br><span class="line">        <span class="keyword">return</span> focus_pos</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">match_all_in</span>(<span class="params">self, screen</span>):</span><br><span class="line">        image = self._imread()</span><br><span class="line">        image = self._resize_image(image, screen, ST.RESIZE_METHOD)</span><br><span class="line">        <span class="keyword">return</span> self._find_all_template(image, screen)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @logwrap</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_cv_match</span>(<span class="params">self, screen</span>):</span><br><span class="line">        <span class="comment"># in case image file not exist in current directory:</span></span><br><span class="line">        ori_image = self._imread()</span><br><span class="line">        image = self._resize_image(ori_image, screen, ST.RESIZE_METHOD)</span><br><span class="line">        ret = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> method <span class="keyword">in</span> ST.CVSTRATEGY:</span><br><span class="line">            <span class="comment"># get function definition and execute:</span></span><br><span class="line">            func = MATCHING_METHODS.get(method, <span class="literal">None</span>)</span><br><span class="line">            <span class="keyword">if</span> func <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">raise</span> InvalidMatchingMethodError(<span class="string">&quot;Undefined method in CVSTRATEGY: &#x27;%s&#x27;, try &#x27;kaze&#x27;/&#x27;brisk&#x27;/&#x27;akaze&#x27;/&#x27;orb&#x27;/&#x27;surf&#x27;/&#x27;sift&#x27;/&#x27;brief&#x27; instead.&quot;</span> % method)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> method <span class="keyword">in</span> [<span class="string">&quot;mstpl&quot;</span>, <span class="string">&quot;gmstpl&quot;</span>]:</span><br><span class="line">                    ret = self._try_match(func, ori_image, screen, threshold=self.threshold, rgb=self.rgb, record_pos=self.record_pos,</span><br><span class="line">                                            resolution=self.resolution, scale_max=self.scale_max, scale_step=self.scale_step)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    ret = self._try_match(func, image, screen, threshold=self.threshold, rgb=self.rgb)</span><br><span class="line">            <span class="keyword">if</span> ret:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_try_match</span>(<span class="params">func, *args, **kwargs</span>):</span><br><span class="line">        G.LOGGING.debug(<span class="string">&quot;try match with %s&quot;</span> % func.__name__)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            ret = func(*args, **kwargs).find_best_result()</span><br><span class="line">        <span class="keyword">except</span> aircv.NoModuleError <span class="keyword">as</span> err:</span><br><span class="line">            G.LOGGING.warning(<span class="string">&quot;&#x27;surf&#x27;/&#x27;sift&#x27;/&#x27;brief&#x27; is in opencv-contrib module. You can use &#x27;tpl&#x27;/&#x27;kaze&#x27;/&#x27;brisk&#x27;/&#x27;akaze&#x27;/&#x27;orb&#x27; in CVSTRATEGY, or reinstall opencv with the contrib module.&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">except</span> aircv.BaseError <span class="keyword">as</span> err:</span><br><span class="line">            G.LOGGING.debug(<span class="built_in">repr</span>(err))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_imread</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> aircv.imread(self.filepath)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_find_all_template</span>(<span class="params">self, image, screen</span>):</span><br><span class="line">        <span class="keyword">return</span> TemplateMatching(image, screen, threshold=self.threshold, rgb=self.rgb).find_all_results()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_find_keypoint_result_in_predict_area</span>(<span class="params">self, func, image, screen</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.record_pos:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># calc predict area in screen</span></span><br><span class="line">        image_wh, screen_resolution = aircv.get_resolution(image), aircv.get_resolution(screen)</span><br><span class="line">        xmin, ymin, xmax, ymax = Predictor.get_predict_area(self.record_pos, image_wh, self.resolution, screen_resolution)</span><br><span class="line">        <span class="comment"># crop predict image from screen</span></span><br><span class="line">        predict_area = aircv.crop_image(screen, (xmin, ymin, xmax, ymax))</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> predict_area.<span class="built_in">any</span>():</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># keypoint matching in predicted area:</span></span><br><span class="line">        ret_in_area = func(image, predict_area, threshold=self.threshold, rgb=self.rgb)</span><br><span class="line">        <span class="comment"># calc cv ret if found</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ret_in_area:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        ret = deepcopy(ret_in_area)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;rectangle&quot;</span> <span class="keyword">in</span> ret:</span><br><span class="line">            <span class="keyword">for</span> idx, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(ret[<span class="string">&quot;rectangle&quot;</span>]):</span><br><span class="line">                ret[<span class="string">&quot;rectangle&quot;</span>][idx] = (item[<span class="number">0</span>] + xmin, item[<span class="number">1</span>] + ymin)</span><br><span class="line">        ret[<span class="string">&quot;result&quot;</span>] = (ret_in_area[<span class="string">&quot;result&quot;</span>][<span class="number">0</span>] + xmin, ret_in_area[<span class="string">&quot;result&quot;</span>][<span class="number">1</span>] + ymin)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_resize_image</span>(<span class="params">self, image, screen, resize_method</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;模板匹配中，将输入的截图适配成 等待模板匹配的截图.&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 未记录录制分辨率，跳过</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.resolution:</span><br><span class="line">            <span class="keyword">return</span> image</span><br><span class="line">        screen_resolution = aircv.get_resolution(screen)</span><br><span class="line">        <span class="comment"># 如果分辨率一致，则不需要进行im_search的适配:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">tuple</span>(self.resolution) == <span class="built_in">tuple</span>(screen_resolution) <span class="keyword">or</span> resize_method <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> image</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(resize_method, types.MethodType):</span><br><span class="line">            resize_method = resize_method.__func__</span><br><span class="line">        <span class="comment"># 分辨率不一致则进行适配，默认使用cocos_min_strategy:</span></span><br><span class="line">        h, w = image.shape[:<span class="number">2</span>]</span><br><span class="line">        w_re, h_re = resize_method(w, h, self.resolution, screen_resolution)</span><br><span class="line">        <span class="comment"># 确保w_re和h_re &gt; 0, 至少有1个像素:</span></span><br><span class="line">        w_re, h_re = <span class="built_in">max</span>(<span class="number">1</span>, w_re), <span class="built_in">max</span>(<span class="number">1</span>, h_re)</span><br><span class="line">        <span class="comment"># 调试代码: 输出调试信息.</span></span><br><span class="line">        G.LOGGING.debug(<span class="string">&quot;resize: (%s, %s)-&gt;(%s, %s), resolution: %s=&gt;%s&quot;</span> % (</span><br><span class="line">                        w, h, w_re, h_re, self.resolution, screen_resolution))</span><br><span class="line">        <span class="comment"># 进行图片缩放:</span></span><br><span class="line">        image = cv2.resize(image, (w_re, h_re))</span><br><span class="line">        <span class="keyword">return</span> image</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    用法:</span></span><br><span class="line"><span class="string">    res = Template(目标图片路径,threshold=匹配阈值,target_pos=可以是123456789 分别对应图片的九个点).match_in(screenshot(None))</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    res = Template(<span class="string">&quot;pppp.png&quot;</span>,threshold=<span class="number">0.8</span>,target_pos=<span class="number">5</span>).match_in(screenshot(<span class="literal">None</span>))</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<h3 id="实战-1"><a href="#实战-1" class="headerlink" title="实战"></a>实战</h3><ul>
<li>安装</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install PyAutoGUI</span><br></pre></td></tr></table></figure>

<ul>
<li>测试代码</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">import pyautogui</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"># 打开记事本</span><br><span class="line">os.popen(&quot;notepad.exe&quot;)</span><br><span class="line">time.sleep(2)</span><br><span class="line"># 查找图片</span><br><span class="line">coords = pyautogui.locateOnScreen(&#x27;1.png&#x27;)</span><br><span class="line"># 得到图片的中心坐标</span><br><span class="line">pos = pyautogui.center(coords)</span><br><span class="line"># 移动鼠标</span><br><span class="line">pyautogui.moveTo(pos, duration=0.5)</span><br><span class="line"># 点击</span><br><span class="line">pyautogui.click()</span><br><span class="line"># 输入内容</span><br><span class="line">pyautogui.typewrite(&#x27;I like Python.&#x27;)</span><br></pre></td></tr></table></figure>

<ul>
<li>查找的1.png图片如下</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20221008161852609.png" alt="image-20221008161852609"></p>
<ul>
<li>测试结果</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20221008161814486.png" alt="image-20221008161814486"></p>
<h2 id="sikulix"><a href="#sikulix" class="headerlink" title="sikulix"></a>sikulix</h2><ul>
<li><p>基于图像识别的开源工具，支持:</p>
<ul>
<li><p><strong>Windows</strong> XP, 7, 8 and 10 (development on Windows 10)</p>
</li>
<li><p><strong>Mac OSX</strong> 10.10 and later (development on macOS 10.15)</p>
</li>
<li><p><strong>Linux&#x2F;Unix</strong> systems depending on the availability of the prerequisites</p>
</li>
</ul>
</li>
<li><p><strong>有自己的IDE</strong></p>
</li>
</ul>
<h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><ul>
<li>java的环境</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;java --version</span><br><span class="line">java 17.0.2 2022-01-18 LTS</span><br><span class="line">Java(TM) SE Runtime Environment (build 17.0.2+8-LTS-86)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 17.0.2+8-LTS-86, mixed mode, sharing)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>打开<a target="_blank" rel="noopener" href="https://raiman.github.io/SikuliX1/downloads.html">官网地址</a>下载sikuli的jar包，现在最新版本为<code>sikulixide-2.0.5-win.jar</code></p>
</li>
<li><p>运行jar，打开ide</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -jar d:\sikulixide-2.0.5-win.jar</span><br><span class="line"></span><br><span class="line">java -jar d:\sikulixide-2.0.5-win.jar -v -c</span><br></pre></td></tr></table></figure>

<h3 id="实战-2"><a href="#实战-2" class="headerlink" title="实战"></a>实战</h3><ul>
<li>打开ide后，写入测试的代码，运行正常，发现一个问题左侧并没有显示常用的api(包括使用快捷键ctrl+t都无反应)</li>
</ul>
<p><img src="/aposts/5639d3cc/image-20221008184205087.png" alt="image-20221008184205087"></p>
<ul>
<li>更多参考<a target="_blank" rel="noopener" href="https://testerhome.com/topics/17225">这里</a>和官网<a target="_blank" rel="noopener" href="https://sikulix-2014.readthedocs.io/en/latest/index.html">api</a></li>
</ul>
<h3 id="基于python使用sikuli图像识别"><a href="#基于python使用sikuli图像识别" class="headerlink" title="基于python使用sikuli图像识别"></a>基于python使用sikuli图像识别</h3><ul>
<li>由于Python不能直接调用Java的方法，需要借助一些第三方的库比如Jython、Jpype、Pyjnius等</li>
<li>安装依赖包</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;pip install JPype1</span><br><span class="line">Collecting JPype1</span><br><span class="line">  Downloading JPype1-1.4.0-cp37-cp37m-win_amd64.whl (343 kB)</span><br><span class="line">     ---------------------------------------- 343.9/343.9 kB 484.9 kB/s eta 0:00:00</span><br><span class="line">Requirement already satisfied: typing-extensions in d:\app\python37\lib\site-packages (from JPype1) (3.7.4.3)</span><br><span class="line">Installing collected packages: JPype1</span><br><span class="line">Successfully installed JPype1-1.4.0</span><br></pre></td></tr></table></figure>

<ul>
<li>测试代码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> jpype <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> jpype</span><br><span class="line"><span class="comment"># 启动java虚拟机，调用sikulixide</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> jpype.isJVMStarted():</span><br><span class="line">    jpype.startJVM(jpype.getDefaultJVMPath(),<span class="string">&#x27;-ea&#x27;</span>,<span class="string">r&#x27;-Djava.class.path=D:\sikulixide-2.0.5-win.jar&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用java的方法</span></span><br><span class="line">java.lang.System.out.println(<span class="string">&quot;hello world&quot;</span>)</span><br><span class="line"><span class="comment"># 获取对应的类，对应api:https://sikulix-2014.readthedocs.io/en/latest/appclass.html#App</span></span><br><span class="line">app =JClass(<span class="string">&#x27;org.sikuli.script.App&#x27;</span>)</span><br><span class="line">app.<span class="built_in">open</span>(<span class="string">r&quot;c:\windows\System32\notepad.exe&quot;</span>)</span><br><span class="line"><span class="comment"># 对应api https://sikulix-2014.readthedocs.io/en/latest/screen.html#Screen</span></span><br><span class="line">Screen = JClass(<span class="string">&#x27;org.sikuli.script.Screen&#x27;</span>)</span><br><span class="line">screen=Screen()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">screen.click(<span class="string">r&quot;D:\project\pc-auto\1.png&quot;</span>)</span><br><span class="line">screen.<span class="built_in">type</span>(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line"></span><br><span class="line">jpype.shutdownJVM()</span><br></pre></td></tr></table></figure>

<ul>
<li>Python调用jar包需要借助于jvm虚拟机，然后需要指定sikulixapi的安装路径,然后将jvm的路径添加到系统的path中（否则会提示jvm无法启动），然后在下方声明一个screen,app类，都是api中的类，然后就可以根据上方的一些方法进行调用</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li><p>如果使用sikuli和PyAutoGUI，最好配合cv2（opencv）进行不同分辨率适配（这里没有测试）</p>
</li>
<li><p>也有人推荐使用Ranorex ，不过这个是收费的</p>
</li>
<li><p>当然还有一些其他场景没有测试，比如嵌入浏览器的场景</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/7680d2c2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/7680d2c2/" class="post-title-link" itemprop="url">英文词缀词根学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-09-13 09:41:00 / 修改时间：10:36:31" itemprop="dateCreated datePublished" datetime="2022-09-13T09:41:00+08:00">2022-09-13</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">英语学习</span></a>
                </span>
            </span>

          
            <span id="/aposts/7680d2c2/" class="post-meta-item leancloud_visitors" data-flag-title="英文词缀词根学习" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/7680d2c2/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/7680d2c2/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>90%的单词都是词根+词缀组成，如下：</p>
<p><img src="/aposts/7680d2c2/image-20220913094440926.png" alt="image-20220913094440926"></p>
<h2 id="秒记词根"><a href="#秒记词根" class="headerlink" title="秒记词根"></a>秒记词根</h2><p>元音互换，改变了词性</p>
<p><img src="/aposts/7680d2c2/image-20220913094704642.png" alt="image-20220913094704642"></p>
<h3 id="拼音元音互换"><a href="#拼音元音互换" class="headerlink" title="拼音元音互换"></a>拼音元音互换</h3><p><img src="/aposts/7680d2c2/image-20220913095347765.png" alt="image-20220913095347765"></p>
<h4 id="U-x3D-V-x3D-W"><a href="#U-x3D-V-x3D-W" class="headerlink" title="U&#x3D;V&#x3D;W"></a>U&#x3D;V&#x3D;W</h4><p><img src="/aposts/7680d2c2/image-20220913100636138.png" alt="image-20220913100636138"></p>
<p><img src="/aposts/7680d2c2/image-20220913100725118.png" alt="image-20220913100725118"></p>
<h4 id="b-x3D-p-x3D-m-x3D-f-x3D-v"><a href="#b-x3D-p-x3D-m-x3D-f-x3D-v" class="headerlink" title="b&#x3D;p&#x3D;m&#x3D;f&#x3D;v"></a>b&#x3D;p&#x3D;m&#x3D;f&#x3D;v</h4><p><img src="/aposts/7680d2c2/image-20220913100904732.png" alt="image-20220913100904732"></p>
<h4 id="g-x3D-k-c-x3D-h"><a href="#g-x3D-k-c-x3D-h" class="headerlink" title="g&#x3D;k(c)&#x3D;h"></a>g&#x3D;k(c)&#x3D;h</h4><p><img src="/aposts/7680d2c2/image-20220913101442142.png" alt="image-20220913101442142"></p>
<h4 id="m-x3D-n-x3D-l-x3D-r"><a href="#m-x3D-n-x3D-l-x3D-r" class="headerlink" title="m&#x3D;n&#x3D;l&#x3D;r"></a>m&#x3D;n&#x3D;l&#x3D;r</h4><p><img src="/aposts/7680d2c2/image-20220913101714851.png" alt="image-20220913101714851"></p>
<p><img src="/aposts/7680d2c2/image-20220913101827379.png" alt="image-20220913101827379"></p>
<h4 id="d-x3D-t-x3D-S-c-x3D-th"><a href="#d-x3D-t-x3D-S-c-x3D-th" class="headerlink" title="d&#x3D;t&#x3D;S(c)&#x3D;th"></a>d&#x3D;t&#x3D;S(c)&#x3D;th</h4><p>dt互换，S(c)和th互换</p>
<p><img src="/aposts/7680d2c2/image-20220913102039924.png" alt="image-20220913102039924"></p>
<p><img src="/aposts/7680d2c2/image-20220913102243220.png" alt="image-20220913102243220"></p>
<p><img src="/aposts/7680d2c2/image-20220913102319133.png" alt="image-20220913102319133"></p>
<h3 id="英文元音互换"><a href="#英文元音互换" class="headerlink" title="英文元音互换"></a>英文元音互换</h3><ul>
<li><p>英语中有26个字母，其中5个元音字母和21个辅音字母。5个元音字母分别为：a[ei]、e[i:]、i[ ai]、o[eu]、u[ju:]。元音发音时声带震动、气流通过口腔不受阻碍</p>
</li>
<li><p><strong>词源不变，语音改变</strong></p>
</li>
</ul>
<p><img src="/aposts/7680d2c2/image-20220913095257600.png" alt="image-20220913095257600"></p>
<p><img src="/aposts/7680d2c2/image-20220913100438436.png" alt="image-20220913100438436"></p>
<h2 id="无词根"><a href="#无词根" class="headerlink" title="无词根"></a>无词根</h2><p><img src="/aposts/7680d2c2/image-20220913102729501.png" alt="image-20220913102729501"></p>
<p><img src="/aposts/7680d2c2/image-20220913102822900.png" alt="image-20220913102822900"></p>
<p><img src="/aposts/7680d2c2/image-20220913102948406.png" alt="image-20220913102948406"></p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>本文主要来自于<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1jR4y1W7bj?spm_id_from=333.999.0.0">这里</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/50861984">英语词根词缀记忆大全简化版</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Dictionaryphile/1000_Eng_Dicts">1000_Eng_Dicts</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/aa9cf483/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/aa9cf483/" class="post-title-link" itemprop="url">httprunner的安装和使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-09-05 11:08:41 / 修改时间：16:41:33" itemprop="dateCreated datePublished" datetime="2022-09-05T11:08:41+08:00">2022-09-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/httprunner/" itemprop="url" rel="index"><span itemprop="name">httprunner</span></a>
                </span>
            </span>

          
            <span id="/aposts/aa9cf483/" class="post-meta-item leancloud_visitors" data-flag-title="httprunner的安装和使用" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/aa9cf483/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/aa9cf483/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><ul>
<li>本次搭建的为在win10下搭建httprunner</li>
</ul>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><ul>
<li><p>通过<a target="_blank" rel="noopener" href="https://github.com/httprunner/httprunner/releases">github</a>下载最新的版本，进行编译，我现在下载的版本为：<code>hrp-v4.2.0-windows-amd64.tar</code></p>
</li>
<li><p>配置环境变量PATH中的hrp的exe路径，<code>D:\app\hrp-v4.2.0-windows-amd64</code></p>
</li>
<li><p>检查配置环境，打开cmd输入：<code>hrp -h</code></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;hrp -h</span><br><span class="line"></span><br><span class="line">License: Apache-2.0</span><br><span class="line">Website: https://httprunner.com</span><br><span class="line">Github: https://github.com/httprunner/httprunner</span><br><span class="line">Copyright 2017 debugtalk</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  hrp [command]</span><br></pre></td></tr></table></figure>

<ul>
<li>创建项目,选择py插件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">D:\project&gt;hrp startproject demo --py</span><br><span class="line">...</span><br><span class="line">1:23AM INF python package is ready name=httprunner version=v4.2.0</span><br><span class="line">11:23AM INF set python3 executable path Python3Executable=&quot;C:\\Users\\Administrator\\.hrp\\venv\\Scripts\\python.exe&quot;</span><br><span class="line">11:23AM INF create scaffold success projectName=demo</span><br></pre></td></tr></table></figure>

<blockquote>
<p>本地python版本为3.7</p>
<p>hrp startproject demo –go 选择go插件</p>
</blockquote>
<h2 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h2><ul>
<li>查看项目代码结构如下：</li>
</ul>
<p><img src="/aposts/aa9cf483/image-20220905153421725.png" alt="image-20220905153421725"></p>
<h3 id="har"><a href="#har" class="headerlink" title="har"></a>har</h3><p> 用 Charles 等抓包工具，以及 Chrome 等浏览器均可以导出 HAR 格式的请求文件，查看<a target="_blank" rel="noopener" href="https://httprunner.com/docs/user-guide/gen-tests/record/">这里</a></p>
<h3 id="reports"><a href="#reports" class="headerlink" title="reports"></a>reports</h3><p>存放测试报告的目录</p>
<h3 id="testcases"><a href="#testcases" class="headerlink" title="testcases"></a>testcases</h3><p> 放测试用例的目录，支持json和yml，看下demo.json的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;config&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;demo with complex mechanisms&quot;,</span><br><span class="line">        &quot;base_url&quot;: &quot;https://postman-echo.com&quot;,</span><br><span class="line">        &quot;variables&quot;: &#123;</span><br><span class="line">            &quot;a&quot;: &quot;$&#123;sum(10, 2.3)&#125;&quot;,</span><br><span class="line">            &quot;b&quot;: 3.45,</span><br><span class="line">            &quot;n&quot;: &quot;$&#123;sum_ints(1, 2, 2)&#125;&quot;,</span><br><span class="line">            &quot;varFoo1&quot;: &quot;$&#123;gen_random_string($n)&#125;&quot;,</span><br><span class="line">            &quot;varFoo2&quot;: &quot;$&#123;max($a, $b)&#125;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;teststeps&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;transaction 1 start&quot;,</span><br><span class="line">            &quot;transaction&quot;: &#123;</span><br><span class="line">                &quot;name&quot;: &quot;tran1&quot;,</span><br><span class="line">                &quot;type&quot;: &quot;start&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;get with params&quot;,</span><br><span class="line">            &quot;request&quot;: &#123;</span><br><span class="line">                &quot;method&quot;: &quot;GET&quot;,</span><br><span class="line">                &quot;url&quot;: &quot;/get&quot;,</span><br><span class="line">                &quot;params&quot;: &#123;</span><br><span class="line">                    &quot;foo1&quot;: &quot;$varFoo1&quot;,</span><br><span class="line">                    &quot;foo2&quot;: &quot;$varFoo2&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;headers&quot;: &#123;</span><br><span class="line">                    &quot;User-Agent&quot;: &quot;HttpRunnerPlus&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;variables&quot;: &#123;</span><br><span class="line">                &quot;b&quot;: 34.5,</span><br><span class="line">                &quot;n&quot;: 3,</span><br><span class="line">                &quot;name&quot;: &quot;get with params&quot;,</span><br><span class="line">                &quot;varFoo2&quot;: &quot;$&#123;max($a, $b)&#125;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;setup_hooks&quot;: [</span><br><span class="line">                &quot;$&#123;setup_hook_example($name)&#125;&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;teardown_hooks&quot;: [</span><br><span class="line">                &quot;$&#123;teardown_hook_example($name)&#125;&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;extract&quot;: &#123;</span><br><span class="line">                &quot;varFoo1&quot;: &quot;body.args.foo1&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;validate&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;status_code&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: 200,</span><br><span class="line">                    &quot;msg&quot;: &quot;check response status code&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;headers.\&quot;Content-Type\&quot;&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;startswith&quot;,</span><br><span class="line">                    &quot;expect&quot;: &quot;application/json&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;body.args.foo1&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;length_equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: 5,</span><br><span class="line">                    &quot;msg&quot;: &quot;check args foo1&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;$varFoo1&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;length_equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: 5,</span><br><span class="line">                    &quot;msg&quot;: &quot;check args foo1&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;body.args.foo2&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: &quot;34.5&quot;,</span><br><span class="line">                    &quot;msg&quot;: &quot;check args foo2&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;transaction 1 end&quot;,</span><br><span class="line">            &quot;transaction&quot;: &#123;</span><br><span class="line">                &quot;name&quot;: &quot;tran1&quot;,</span><br><span class="line">                &quot;type&quot;: &quot;end&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;post json data&quot;,</span><br><span class="line">            &quot;request&quot;: &#123;</span><br><span class="line">                &quot;method&quot;: &quot;POST&quot;,</span><br><span class="line">                &quot;url&quot;: &quot;/post&quot;,</span><br><span class="line">                &quot;body&quot;: &#123;</span><br><span class="line">                    &quot;foo1&quot;: &quot;$varFoo1&quot;,</span><br><span class="line">                    &quot;foo2&quot;: &quot;$&#123;max($a, $b)&#125;&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;validate&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;status_code&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: 200,</span><br><span class="line">                    &quot;msg&quot;: &quot;check status code&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;body.json.foo1&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;length_equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: 5,</span><br><span class="line">                    &quot;msg&quot;: &quot;check args foo1&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;body.json.foo2&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: 12.3,</span><br><span class="line">                    &quot;msg&quot;: &quot;check args foo2&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;post form data&quot;,</span><br><span class="line">            &quot;request&quot;: &#123;</span><br><span class="line">                &quot;method&quot;: &quot;POST&quot;,</span><br><span class="line">                &quot;url&quot;: &quot;/post&quot;,</span><br><span class="line">                &quot;headers&quot;: &#123;</span><br><span class="line">                    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded; charset=UTF-8&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;body&quot;: &#123;</span><br><span class="line">                    &quot;foo1&quot;: &quot;$varFoo1&quot;,</span><br><span class="line">                    &quot;foo2&quot;: &quot;$&#123;max($a, $b)&#125;&quot;,</span><br><span class="line">                    &quot;time&quot;: &quot;$&#123;get_timestamp()&#125;&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;extract&quot;: &#123;</span><br><span class="line">                &quot;varTime&quot;: &quot;body.form.time&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;validate&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;status_code&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: 200,</span><br><span class="line">                    &quot;msg&quot;: &quot;check status code&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;body.form.foo1&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;length_equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: 5,</span><br><span class="line">                    &quot;msg&quot;: &quot;check args foo1&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;body.form.foo2&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: &quot;12.3&quot;,</span><br><span class="line">                    &quot;msg&quot;: &quot;check args foo2&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;: &quot;get with timestamp&quot;,</span><br><span class="line">            &quot;request&quot;: &#123;</span><br><span class="line">                &quot;method&quot;: &quot;GET&quot;,</span><br><span class="line">                &quot;url&quot;: &quot;/get&quot;,</span><br><span class="line">                &quot;params&quot;: &#123;</span><br><span class="line">                    &quot;time&quot;: &quot;$varTime&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;validate&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;check&quot;: &quot;body.args.time&quot;,</span><br><span class="line">                    &quot;assert&quot;: &quot;length_equals&quot;,</span><br><span class="line">                    &quot;expect&quot;: 13,</span><br><span class="line">                    &quot;msg&quot;: &quot;check extracted var timestamp&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在json里面引用的函数如<code>&#123;sum(10, 2.3)&#125;</code>，需要在<code>debugtalk.py</code>自定义，但是<code>max</code>应该为内置函数，不用自定义编写</li>
<li>事务代码说明</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">type Transaction struct &#123;</span><br><span class="line">   Name string          `json:&quot;name&quot; yaml:&quot;name&quot;` // 事务名称，可定义为任意字符串</span><br><span class="line">   Type transactionType `json:&quot;type&quot; yaml:&quot;type&quot;` // 事务类型，仅包括 2 种类型，start（事务开始）和 end（结束事务）</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>在测试用例中，transaction 应该成对出现，即必须同时定义 start 和 end；如果存在配对缺失的情况，会按照如下逻辑进行处理：<ul>
<li>仅设置开始事务，则会在测试用例最后一个测试步后添加结束事务</li>
<li>仅设置结束事务，则会在测试用例第一个测试步前添加开始事务</li>
</ul>
</li>
</ul>
</blockquote>
<ul>
<li>更多的手工编写用例<a target="_blank" rel="noopener" href="https://httprunner.com/docs/user-guide/gen-tests/write-cases/">介绍</a></li>
</ul>
<h3 id="其他文件"><a href="#其他文件" class="headerlink" title="其他文件"></a>其他文件</h3><ul>
<li><code>.env</code> 配置环境变量信息，如登录的信息</li>
<li><code>debugtalk.py</code> 自定义函数</li>
<li><code>proj.json</code> 项目的信息</li>
</ul>
<h2 id="运行用例"><a href="#运行用例" class="headerlink" title="运行用例"></a>运行用例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">D:\project\demo&gt;hrp run testcases\demo.json --gen-html-report</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">==================== response ====================</span><br><span class="line">Connected via TLSv1.2</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Length: 406</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Type: application/json; charset=utf-8</span><br><span class="line">Date: Mon, 05 Sep 2022 08:08:52 GMT</span><br><span class="line">Etag: W/&quot;196-F4bYgnayuG8mswnHB8kP+Hk/6J4&quot;</span><br><span class="line">Set-Cookie: sails.sid=s%3AF7CgL7_NwzZjvKsH7GKmjPHovUPl7kza.7RUa8O71oEJjVUKcWKAkLw0m0ztEnlmlVzJimZz5H2E; Path=/; HttpOnly</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line"></span><br><span class="line">&#123;&quot;args&quot;:&#123;&quot;time&quot;:&quot;1662365339120&quot;&#125;,&quot;headers&quot;:&#123;&quot;x-forwarded-proto&quot;:&quot;https&quot;,&quot;x-forwarded-port&quot;:&quot;443&quot;,&quot;host&quot;:&quot;postman-echo.com&quot;,&quot;x-amzn-trace-id&quot;:&quot;Root=1-6315ae94-58d38b1f1c45c8b94273a5a3&quot;,&quot;user-agent&quot;:&quot;Go-http-client/1.1&quot;,&quot;cookie&quot;:&quot;sails.sid=s%3A9zczVs9TODPR3d-xi5F59muThb8LgjjY.bDP%2FcJnt8Ou9QPjs7Y9v15utVqCU%2FrK3EddVu6ThODc&quot;,&quot;accept-encoding&quot;:&quot;gzip&quot;&#125;,&quot;url&quot;:&quot;https://postman-echo.com/get?time=1662365339120&quot;&#125;</span><br><span class="line">--------------------------------------------------</span><br><span class="line">4:08PM INF validate body.args.time assertMethod=length_equals checkExpr=body.args.time checkValue=1662365339120 checkValueType=string expectValue=13 expectValueType=int64 result=true</span><br><span class="line">4:08PM INF run step end exportVars=null step=&quot;get with timestamp&quot; success=true type=request</span><br><span class="line">4:08PM INF run testcase end testcase=&quot;demo with complex mechanisms&quot;</span><br><span class="line">4:08PM INF quit hashicorp plugin process</span><br><span class="line">2022-09-05T16:09:01.733+0800 [WARN]  grpc-py: plugin failed to exit gracefully</span><br></pre></td></tr></table></figure>

<blockquote>
<p>pytest也支持，测试 case 的文件应该以 _test 结尾</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;hrp pytest testcases/py_test.py --html=/report/index.html  --junit-xml=/report/report.xml</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li>执行完成后，在reports目录发现了测试报告的html文件</li>
</ul>
<p><img src="/aposts/aa9cf483/image-20220905161310265.png" alt="image-20220905161310265"></p>
<h2 id="关于登录"><a href="#关于登录" class="headerlink" title="关于登录"></a>关于登录</h2><p>很多用例都是需要登录后才能处理，如果比较简单可以类似这样处理，下面取token</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- config:</span><br><span class="line">    name: logincase</span><br><span class="line">    variables: &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">teststeps:</span><br><span class="line">-</span><br><span class="line">    name: login case1</span><br><span class="line">    request:</span><br><span class="line">        url: http://127.0.0.1:8000/api/v1/login/</span><br><span class="line">        method: POST</span><br><span class="line">        headers:</span><br><span class="line">            Content-Type: application/json</span><br><span class="line">            User-Agent: python-requests/2.18.4</span><br><span class="line">        json:</span><br><span class="line">            username: test</span><br><span class="line">            password: 123456</span><br><span class="line">    extract:</span><br><span class="line">        - token: content.token         # 提取token</span><br><span class="line">- </span><br><span class="line">    name: get user info case1</span><br><span class="line">    request:</span><br><span class="line">        url: http://127.0.0.1:8000/api/v1/user/info/</span><br><span class="line">        method: GET</span><br><span class="line">        headers:</span><br><span class="line">            Content-Type: application/json</span><br><span class="line">            User-Agent: python-requests/2.18.4</span><br><span class="line">            Authorization: Token $token          # 引用token</span><br></pre></td></tr></table></figure>

<ul>
<li>cookie</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- config:</span><br><span class="line">    name: logincase</span><br><span class="line">    variables: &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">teststeps:</span><br><span class="line">-</span><br><span class="line">    name: login case1</span><br><span class="line">    request:</span><br><span class="line">        url: http://127.0.0.1:8000/api/v1/login/</span><br><span class="line">        method: POST</span><br><span class="line">        headers:</span><br><span class="line">            Content-Type: application/json</span><br><span class="line">            User-Agent: python-requests/2.18.4</span><br><span class="line">        json:</span><br><span class="line">            username: test</span><br><span class="line">            password: 123456</span><br><span class="line">    extract:</span><br><span class="line">        - cookievalue: headers.Set-Cookie # 提取Cookie</span><br><span class="line">- </span><br><span class="line">    name: get user info case1</span><br><span class="line">    request:</span><br><span class="line">        url: http://127.0.0.1:8000/api/v1/user/info/</span><br><span class="line">        method: GET</span><br><span class="line">        headers:</span><br><span class="line">            Content-Type: application/json</span><br><span class="line">            User-Agent: python-requests/2.18.4</span><br><span class="line">            cookie: $cookievalue # 把提取到的 cookies 附加到本次请求头域  </span><br></pre></td></tr></table></figure>

<ul>
<li>如果是比较复杂的登录校验，可以采用<code>setup_hooks</code>调用自定义函数（<code>debugtalk.py</code>中编写）完成登录校验</li>
</ul>
<h2 id="性能压测"><a href="#性能压测" class="headerlink" title="性能压测"></a>性能压测</h2><ul>
<li>关于性能测试，可以参考<a target="_blank" rel="noopener" href="https://httprunner.com/docs/user-guide/load-test/">这里</a>，需要用go</li>
<li>本地的项目需要采用<code>hrp startproject demo --go</code>来新建go插件的项目</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/b1138623/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/b1138623/" class="post-title-link" itemprop="url">重装heox的问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-26 18:11:46" itemprop="dateCreated datePublished" datetime="2022-08-26T18:11:46+08:00">2022-08-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-09-16 15:35:10" itemprop="dateModified" datetime="2022-09-16T15:35:10+08:00">2022-09-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a>
                </span>
            </span>

          
            <span id="/aposts/b1138623/" class="post-meta-item leancloud_visitors" data-flag-title="重装heox的问题" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/b1138623/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/b1138623/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><ul>
<li>由于某原因，把node和hexo升级后，造成无法发生文章到服务器了，记录解决方法</li>
<li><a href="/aposts/830a4d3a/">迁移博客到腾讯云</a></li>
</ul>
<h2 id="本地环境"><a href="#本地环境" class="headerlink" title="本地环境"></a>本地环境</h2><ul>
<li>准备空的文件夹，用hexo进行初始化</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init XXXXX/</span><br></pre></td></tr></table></figure>

<ul>
<li>安装依赖文件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-helper-live2d --save</span><br><span class="line">npm install hexo-asset-image --save</span><br><span class="line">npm install hexo-tag-cloud --save </span><br><span class="line">npm install hexo-abbrlink --save</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<ul>
<li><code>hexo-asset-image</code>和<code>hexo-abbrlink </code>有冲突，造成图片无法展示，修改<code>asset-image</code>的<code>index.js</code>中代码</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># E:\moon-full-blog\node_modules\hexo-asset-image\index.js</span><br><span class="line"></span><br><span class="line">//var endPos = link.lastIndexOf(&#x27;.&#x27;);</span><br><span class="line">var endPos = link.lastIndexOf(&#x27;/&#x27;);</span><br></pre></td></tr></table></figure>

<ul>
<li>创建本地的<code>id_rsa.pub</code>的密码</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -C &quot;2847XXX@qq.com&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>服务器上新增文件，把本地<code>id_rsa.pub</code>的密码拷贝进去</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.ssh/authorized_keys</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>修改权限</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod 755 ~</span><br><span class="line">chmod 700 ~/.ssh</span><br><span class="line">chmod 600 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

<ul>
<li>测试本地连接服务器，提示输入密码，注意我的用的root用户名</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh -v root@82.XX.xx.xx</span><br><span class="line"></span><br><span class="line">debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0</span><br><span class="line">Last login: Fri Aug 26 17:59:47 2022 from 116.128.233.192</span><br><span class="line">Last login: Fri Aug 26 17:59:47 2022 from 116.128.233.192</span><br></pre></td></tr></table></figure>

<ul>
<li><p>然后把本地之前的博客的<code>config.yml</code>，主题文件夹，<code>source</code> 拷贝带最新的博客目录</p>
</li>
<li><p>设置邮箱</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.email &#x27;28477XXX4@qq.com&#x27;</span><br></pre></td></tr></table></figure>

<ul>
<li>提交到服务器</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl &amp;&amp;  hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/f586e041/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/f586e041/" class="post-title-link" itemprop="url">Sonic云真机测试平台使用指南</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-22 10:37:34" itemprop="dateCreated datePublished" datetime="2022-08-22T10:37:34+08:00">2022-08-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-26 15:20:41" itemprop="dateModified" datetime="2022-08-26T15:20:41+08:00">2022-08-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Sonic/" itemprop="url" rel="index"><span itemprop="name">Sonic</span></a>
                </span>
            </span>

          
            <span id="/aposts/f586e041/" class="post-meta-item leancloud_visitors" data-flag-title="Sonic云真机测试平台使用指南" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/f586e041/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/f586e041/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>本次主要记录win10_X64下搭建Sonic的使用步骤</p>
<h2 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h2><h3 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h3><ul>
<li>安装过程中出现很多问题，因为我的系统为家庭版本，所以需要安装<code>wsl2</code>，<code>Ubuntu 18.04.5 LTS</code>等，重装系统了为专业版本，直接就可以安装</li>
</ul>
<p><img src="/aposts/f586e041/image-20220823170502758.png" alt="image-20220823170502758"></p>
<ul>
<li><p>打开<a target="_blank" rel="noopener" href="https://docs.docker.com/desktop/install/windows-install/">官网</a>下载并安装，重启电脑，进入到bios，打开虚拟化</p>
</li>
<li><p>打开Docker Desktop，正常启动后，打开cmd，输入命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;docker run -d -p 80:80 docker/getting-started</span><br><span class="line">Unable to find image &#x27;docker/getting-started:latest&#x27; locally</span><br><span class="line">latest: Pulling from docker/getting-started</span><br><span class="line">....</span><br><span class="line">dsha256:b558be874169471bd4e65bd6eac8c303b271a7ee8553ba47481b73b2bf597aae</span><br><span class="line">Status: Downloaded newer image for docker/getting-started:latest</span><br><span class="line">8df47bc4fdb1ec2ac47a70f609e8e73dc6afb62298c570b27b1ae9032fdd036d</span><br></pre></td></tr></table></figure>

<p>进入 docker 里可以看到测试运行的容器。</p>
<p><img src="/aposts/f586e041/image-20220823170833149.png" alt="image-20220823170833149"></p>
</li>
</ul>
<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p>打开<a target="_blank" rel="noopener" href="https://downloads.mysql.com/archives/community/">官网</a>，下载8.0的版本</p>
<p><img src="/aposts/f586e041/image-20220823171802303.png" alt="image-20220823171802303"></p>
<ul>
<li><p>设置环境变量：<code>D:\app\mysql-8.0.13-winx64\bin</code></p>
</li>
<li><p>在mysql的安装目录新建my.ini</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">port=3306</span><br><span class="line"># 字符集设置</span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">port=3306</span><br><span class="line">character_set_server=utf8</span><br><span class="line"># 设置安装目录</span><br><span class="line">basedir=D:\app\mysql-8.0.13-winx64</span><br><span class="line"># 设置数据存放位置</span><br><span class="line">datadir=D:\app\mysql-8.0.13-winx64\data</span><br></pre></td></tr></table></figure>

<ul>
<li>通过 <code>mysqld --initialize --console</code> 命令来重置密码。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;mysqld --initialize --console</span><br><span class="line">2022-08-23T09:26:32.002602Z 0 [System] [MY-013169] [Server] D:\app\mysql-8.0.13-generated for root@localhost: QCHDW*9OpYQX</span><br><span class="line">2022-08-23T09:26:37.215593Z 0 [System] [MY-013170] [Server] D:\app\mysql-8.0.13-winx64\bin\mysqld.exe (mysqld 8.0.13) initializing of server has completed</span><br></pre></td></tr></table></figure>

<ul>
<li>登录并修改root用户的密码</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;mysqld -install</span><br><span class="line">Service successfully installed.</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;net start mysql</span><br><span class="line">MySQL 服务正在启动 .</span><br><span class="line">MySQL 服务已经启动成功。</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;mysql -u root -p</span><br><span class="line"></span><br><span class="line">mysql&gt;  alter user &#x27;root&#x27;@&#x27;localhost&#x27; identified by &#x27;123456&#x27;;</span><br><span class="line">Query OK, 0 rows affected (0.05 sec)</span><br></pre></td></tr></table></figure>

<ul>
<li>退出重新登陆验证</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; exit;</span><br><span class="line">Bye</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;mysql -u root -p</span><br><span class="line">Enter password: ******</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to</span><br></pre></td></tr></table></figure>

<ul>
<li>修改可以支持远程用IP访问</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">mysql&gt; select host, user from user;</span><br><span class="line">+-----------+------------------+</span><br><span class="line">| host      | user             |</span><br><span class="line">+-----------+------------------+</span><br><span class="line">| localhost | mysql.infoschema |</span><br><span class="line">| localhost | mysql.session    |</span><br><span class="line">| localhost | mysql.sys        |</span><br><span class="line">| localhost | root             |</span><br><span class="line">+-----------+------------------+</span><br><span class="line">4 rows in set (0.01 sec)</span><br><span class="line"># 查看表格中 root 用户的 host，默认应该显示的 localhost，只支持本地访问，不允许远程访问</span><br><span class="line"></span><br><span class="line">mysql&gt; update user set host=&#x27;%&#x27; where user =&#x27;root&#x27;;</span><br><span class="line"># 说明： % 代表任意的客户端,可替换成具体IP地址。</span><br><span class="line"></span><br><span class="line">Query OK, 1 row affected (0.08 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br></pre></td></tr></table></figure>

<p><img src="/aposts/f586e041/image-20220823175019789.png" alt="image-20220823175019789"></p>
<h2 id="本地配置"><a href="#本地配置" class="headerlink" title="本地配置"></a>本地配置</h2><ul>
<li><p>在<code>d:\sonic</code> 目录中下载<a target="_blank" rel="noopener" href="https://sonic-cloud.gitee.io/#/Deploy">官网</a>的最新的部署包，我下载的为sonic-server-v1.5.0-beta，根据实际情况修改env的内容，主要是 ip，数据库的密码</p>
</li>
<li><p>手动建立数据库:<code>sonic</code></p>
</li>
<li><p>执行docker-compose</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\sonic\sonic-server-v1.5.0-beta&gt;docker-compose up -d</span><br><span class="line">sonic-server-v150-beta_sonic-server-eureka_1 is up-to-date</span><br><span class="line">sonic-server-v150-beta_sonic-server-controller_1 is up-to-date</span><br><span class="line">sonic-server-v150-beta_sonic-server-gateway_1 is up-to-date</span><br><span class="line">sonic-server-v150-beta_sonic-client-web_1 is up-to-date</span><br><span class="line">Creating sonic-server-v150-beta_sonic-server-folder_1 ... done                                                          </span><br></pre></td></tr></table></figure>

<ul>
<li>打开<code>http://localhost:3000/</code>，注册后，自动登录</li>
</ul>
<p><img src="/aposts/f586e041/image-20220824095329636.png" alt="image-20220824095329636"></p>
<h2 id="Sonic配置"><a href="#Sonic配置" class="headerlink" title="Sonic配置"></a>Sonic配置</h2><h3 id="本机环境-java"><a href="#本机环境-java" class="headerlink" title="本机环境-java"></a>本机环境-java</h3><ul>
<li>下载并配置Java，我的版本为</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;java -version</span><br><span class="line">java version &quot;17.0.2&quot; 2022-01-18 LTS</span><br><span class="line">Java(TM) SE Runtime Environment (build 17.0.2+8-LTS-86)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 17.0.2+8-LTS-86, mixed mode, sharing)</span><br></pre></td></tr></table></figure>

<h3 id="appium安装"><a href="#appium安装" class="headerlink" title="appium安装"></a>appium安装</h3><p>下载<a target="_blank" rel="noopener" href="https://www.androiddevtools.cn/">android sdk tools</a>，选择exe文件安装后，并打开</p>
<p><img src="/aposts/f586e041/image-20220824103828375.png" alt="image-20220824103828375"></p>
<ul>
<li>因为用于 <strong>Appium</strong> 自动化，只需要勾选下面的 <strong>4</strong> 个包就行了，需要挂梯子</li>
</ul>
<p><img src="/aposts/f586e041/image-20220824104049673.png" alt="image-20220824104049673"></p>
<p><img src="/aposts/f586e041/image-20220824104117977.png" alt="image-20220824104117977"></p>
<ul>
<li>创建<code>ANDROID_HOME</code>的环境变量：<code>D:\app\android-sdk</code></li>
<li>SDK的platform-tools和tool的路径添加到<code>Path</code> 变量内<code> %ANDROID_HOME%\platform-tools</code>、<code>%ANDROID_HOME%\tools</code>、<code>%ANDROID_HOME%\build-tools\29.0.2</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;adb version</span><br><span class="line">Android Debug Bridge version 1.0.41</span><br><span class="line">Version 29.0.6-6198805</span><br><span class="line">Installed as D:\app\android-sdk\platform-tools\adb.exe</span><br></pre></td></tr></table></figure>

<ul>
<li>下载并安装node.js</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Administrator@WIN-5TF67LA12I4 MINGW64 /d/app/node-v14.20.0-win-x64</span><br><span class="line">$ npm -v</span><br><span class="line">6.14.17</span><br><span class="line"></span><br><span class="line">Administrator@WIN-5TF67LA12I4 MINGW64 /d/app/node-v14.20.0-win-x64</span><br><span class="line">$ node -v</span><br><span class="line">v14.20.0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>安装appium，采用npm，尝试过了用cnpm经常报错，使用git的命令窗口</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm cache clear --force # 清空缓存，如果报错的话，可以</span><br><span class="line"># 挂了代理，在git窗口中设置了代理</span><br><span class="line">export https_proxy=http://127.0.0.1:33210 http_proxy=http://127.0.0.1:33210 all_proxy=socks5://127.0.0.1:33211</span><br><span class="line"></span><br><span class="line">npm i -g appium  </span><br></pre></td></tr></table></figure>

<ul>
<li>装doctor，用来检查appium是否正常</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ npm install appium-doctor -g</span><br><span class="line">npm WARN deprecated authorize-ios@1.2.1: Moved into appium</span><br><span class="line">npm WARN deprecated debug@4.1.1: Debug versions &gt;=3.2.0 &lt;3.2.7 || &gt;=4 &lt;4.3.1 have a low-severity ReDos regression when used in a Node.js environment. It is recommended you upgrade to 3.2.7 or 4.3.1. (https://github.com/visionmedia/debug/issues/797)</span><br><span class="line">D:\app\node-v14.20.0-win-x64\appium-doctor -&gt; D:\app\node-v14.20.0-win-x64\node_modules\appium-doctor\appium-doctor.js</span><br><span class="line">+ appium-doctor@1.16.0</span><br><span class="line">added 240 packages from 297 contributors in 74.211s</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>检查appium，执行<code>./appium-doctor</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Administrator@WIN-5TF67LA12I4 MINGW64 /d/app/node-v14.20.0-win-x64</span><br><span class="line">$ ./appium-doctor</span><br><span class="line">info AppiumDoctor Appium Doctor v.1.16.0</span><br><span class="line">info AppiumDoctor ### Diagnostic for necessary dependencies starting ###</span><br><span class="line">info AppiumDoctor  ✔ The Node.js binary was found at: D:\app\node-v14.20.0-win-x64\node.EXE</span><br><span class="line">info AppiumDoctor  ✔ Node version is 14.20.0</span><br><span class="line">info AppiumDoctor  ✔ ANDROID_HOME is set to: D:\app\android-sdk</span><br><span class="line">info AppiumDoctor  ✔ JAVA_HOME is set to: D:\app\Java\jdk-17.0.2</span><br><span class="line">info AppiumDoctor    Checking adb, android, emulator</span><br><span class="line">info AppiumDoctor      &#x27;adb&#x27; is in D:\app\android-sdk\platform-tools\adb.exe</span><br><span class="line">info AppiumDoctor      &#x27;android&#x27; is in D:\app\android-sdk\tools\android.bat</span><br><span class="line">info AppiumDoctor      &#x27;emulator&#x27; is in D:\app\android-sdk\tools\emulator.exe</span><br><span class="line">info AppiumDoctor  ✔ adb, android, emulator exist: D:\app\android-sdk</span><br><span class="line">info AppiumDoctor  ✔ &#x27;bin&#x27; subfolder exists under &#x27;D:\app\Java\jdk-17.0.2&#x27;</span><br><span class="line">info AppiumDoctor ### Diagnostic for necessary dependencies completed, no fix needed. ###</span><br><span class="line">info AppiumDoctor</span><br><span class="line">info AppiumDoctor ### Diagnostic for optional dependencies starting ###</span><br><span class="line">WARN AppiumDoctor  ✖ opencv4nodejs cannot be found.</span><br><span class="line">WARN AppiumDoctor  ✖ ffmpeg cannot be found</span><br><span class="line">WARN AppiumDoctor  ✖ mjpeg-consumer cannot be found.</span><br><span class="line">WARN AppiumDoctor  ✖ bundletool.jar cannot be found</span><br><span class="line">WARN AppiumDoctor  ✖ gst-launch-1.0.exe and/or gst-inspect-1.0.exe cannot be found</span><br><span class="line">info AppiumDoctor ### Diagnostic for optional dependencies completed, 5 fixes possible. ...</span><br><span class="line"></span><br><span class="line">info AppiumDoctor Bye! </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>直接输入<code>appium</code> 启动，没问题后就可以关闭了，不要手动去启动appium</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Administrator@WIN-5TF67LA12I4 MINGW64 /d/app/node-v14.20.0-win-x64</span><br><span class="line">$ appium</span><br><span class="line">[Appium] Welcome to Appium v1.22.3</span><br><span class="line">[Appium] Appium REST http interface listener started on 0.0.0.0:4723</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>安装adbkit，用adb进行调试</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g adbkit</span><br></pre></td></tr></table></figure>

<h3 id="sonic文件配置"><a href="#sonic文件配置" class="headerlink" title="sonic文件配置"></a>sonic文件配置</h3><ul>
<li>新增angent</li>
</ul>
<p><img src="/aposts/f586e041/image-20220824174006767.png" alt="image-20220824174006767"></p>
<ul>
<li><p>打开<a target="_blank" rel="noopener" href="https://download.sonic-cloud.wiki/sonic/sonic-agent/v1.5.0-beta">官网</a>下载<code>sonic-agent-v1.5.0-beta-windows_x86_64</code>解压</p>
</li>
<li><p>打开配置文件，我的路径为：<code>D:\sonic\sonic-agent-v1.5.0-beta-windows_x86_64\config\application-sonic-agent.yml</code></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">sonic:</span><br><span class="line">  agent:</span><br><span class="line">    # 替换为部署Agent机器的ipv4</span><br><span class="line">    host: 172.31.104.166</span><br><span class="line">    # 替换为Agent服务的端口，可以自行更改</span><br><span class="line">    port: 7777</span><br><span class="line">    # 替换为前端新增Agent生成的key</span><br><span class="line">    key: XXXXXX</span><br><span class="line">  server:</span><br><span class="line">    # 改成server的SONIC_SERVER_HOST</span><br><span class="line">    host: 172.31.104.166</span><br><span class="line">    # 改成server的SONIC_SERVER_PORT</span><br><span class="line">    port: 3000</span><br><span class="line"></span><br><span class="line">modules:</span><br><span class="line">  android:</span><br><span class="line">    # 是否开启安卓模块</span><br><span class="line">    enable: true</span><br><span class="line">    # 是否开启远程adb调试功能</span><br><span class="line">    use-adbkit: true</span><br><span class="line">  ios:</span><br><span class="line">    # 如果不需要连接iOS设备，请将true改为false。开启的windows用户请确保本机已安装iTunes</span><br><span class="line">    enable: false</span><br><span class="line">    # 替换为你自己使用的wda的bundleId，如果没有.xctrunner后缀会自动补全，建议使用公司的开发者证书</span><br><span class="line">    wda-bundle-id: com.sonic.WebDriverAgentRunner</span><br><span class="line">  appium:</span><br><span class="line">    # 是否开启Appium功能</span><br><span class="line">    enable: true</span><br><span class="line">  webview:</span><br><span class="line">    # 是否开启在线webView调试功能</span><br><span class="line">    enable: false</span><br><span class="line">    # 谷歌调试端口，一般不需要修改（默认0使用随机端口，如果需要开启防火墙给外部使用，请设置固定端口如7778）</span><br><span class="line">    chrome-driver-debug-port: 0</span><br><span class="line">    # 替换为Agent机器上的chrome浏览器的driver路径，可以去http://npm.taobao.org/mirrors/chromedriver/下载</span><br><span class="line">    chrome-driver-path: &quot;/Applications/Google Chrome.app/Contents/MacOS/chromedriver&quot;</span><br><span class="line">  sgm:</span><br><span class="line">    enable: true</span><br></pre></td></tr></table></figure>

<ul>
<li>启动agent</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\sonic\sonic-agent-v1.5.0-beta-windows_x86_64&gt;java -jar sonic-agent-windows-x86_64.jar</span><br></pre></td></tr></table></figure>

<p><img src="/aposts/f586e041/image-20220824174158573.png" alt="image-20220824174158573"></p>
<ul>
<li>手机打开开发者模式后，连接电脑（agent）后，打开web页面的设备</li>
</ul>
<p><img src="/aposts/f586e041/image-20220824175641741.png" alt="image-20220824175641741"></p>
<h2 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h2><h3 id="sonic的配置"><a href="#sonic的配置" class="headerlink" title="sonic的配置"></a>sonic的配置</h3><ul>
<li>新建项目，点击项目</li>
</ul>
<p><img src="/aposts/f586e041/image-20220824175944576.png" alt="image-20220824175944576"></p>
<ul>
<li>打开设备中心，选择空闲设备，选择使用</li>
</ul>
<p><img src="/aposts/f586e041/image-20220824180220297.png" alt="image-20220824180220297"></p>
<p><img src="/aposts/f586e041/image-20220824180249666.png" alt="image-20220824180249666"></p>
<ul>
<li>点击控件元素，获取到元素后，直接添加控件</li>
</ul>
<p><img src="/aposts/f586e041/image-20220826085653821.png" alt="image-20220826085653821"></p>
<p><img src="/aposts/f586e041/image-20220826085812310.png" alt="image-20220826085812310"></p>
<ul>
<li><p>用例的步骤关联-上面的控件元素</p>
</li>
<li><p>套件关联多个用例</p>
</li>
<li><p>查看测试报告</p>
</li>
</ul>
<p><img src="/aposts/f586e041/image-20220826094320795.png" alt="image-20220826094320795"></p>
<ul>
<li>支持多个设备同时运行所有用例</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li><p>优点：远程的手机管理，统一的用例维护，多机运行用例。</p>
</li>
<li><p>不足</p>
<ul>
<li>不支持分布式用例</li>
<li>用例查找不支持显示等待，这个问题需要等后续的版本脱离appium后，可以处理</li>
</ul>
</li>
<li><p>已经支持使用poco的控件的获取，这对游戏应用来说，是个很好的消息。</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/177838dd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/177838dd/" class="post-title-link" itemprop="url">kdevtmpfsi--服务器CPU占用高、内存占用高</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-08-22 09:59:17 / 修改时间：10:15:57" itemprop="dateCreated datePublished" datetime="2022-08-22T09:59:17+08:00">2022-08-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" itemprop="url" rel="index"><span itemprop="name">环境搭建</span></a>
                </span>
            </span>

          
            <span id="/aposts/177838dd/" class="post-meta-item leancloud_visitors" data-flag-title="kdevtmpfsi--服务器CPU占用高、内存占用高" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/177838dd/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/177838dd/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>这篇<a href="aposts/d4ea272f/">文章</a>，后续的结论说是服务器配置不够观点是错误的，经过排查发现是服务器中毒了，经过<code>top</code>排查到了是有个叫<code>kdevtmpfsi</code>的后台进程太大造成，搜了下相关资料刚好有人和我相同的问题，把解决方案就<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37282062/article/details/108645671">转载</a>了过来</p>
<h2 id="中毒具体描述"><a href="#中毒具体描述" class="headerlink" title="中毒具体描述"></a>中毒具体描述</h2><ul>
<li>某一天，我写完本地程序，准备部署到云服务器，然而我的<code>xshell</code>始终是连接不上服务器，或者是连接上反应非常慢，我怀疑阿里云对我的服务器动了什么了（实在是对不住，毕竟我也不知道还有这种事情），然后通过阿里云控制台，发现出现了CPU占用非常高，基本上就100%了，并且内存的占用也是非常高。通过登录服务器，具体查看，然后使用命令查看，确实正如控制台的监控系统所展示的那样。</li>
</ul>
<h2 id="命令以及过程"><a href="#命令以及过程" class="headerlink" title="命令以及过程"></a>命令以及过程</h2><ul>
<li><p>查看cpu占用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看异常进程 <code>kdevtmpfsi</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep kdevtmpfsi</span><br></pre></td></tr></table></figure>
</li>
<li><p>处理异常定时任务</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 查看定时任务，找出异常任务</span><br><span class="line">crontab -l</span><br><span class="line"></span><br><span class="line"># 删除一次任务</span><br><span class="line">crontab -e</span><br></pre></td></tr></table></figure>



<ul>
<li><p>查看和其相关联的进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl status pid</span><br><span class="line"># pid 为kdevtmpfsi的进程号</span><br></pre></td></tr></table></figure>


</li>
<li><p>杀掉进程(包括其守护进程，由上一步可以看出)，先杀守护进程，后杀挖矿进程</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 pid</span><br></pre></td></tr></table></figure>

<ul>
<li>删除守护进程文件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 查找守护进程相关文件</span><br><span class="line">find / -name kins*</span><br><span class="line"></span><br><span class="line"># 删除文件</span><br><span class="line">rm -rf path</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>删除挖矿程序文件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 查找文件</span><br><span class="line">find / -name kdevtmpfsi*</span><br><span class="line"># 删除</span><br><span class="line">rm -rf path</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/9dc1ed8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/9dc1ed8/" class="post-title-link" itemprop="url">chrome无保存密码提示</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-08-22 09:41:35 / 修改时间：09:55:24" itemprop="dateCreated datePublished" datetime="2022-08-22T09:41:35+08:00">2022-08-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8/" itemprop="url" rel="index"><span itemprop="name">软件使用</span></a>
                </span>
            </span>

          
            <span id="/aposts/9dc1ed8/" class="post-meta-item leancloud_visitors" data-flag-title="chrome无保存密码提示" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/9dc1ed8/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/9dc1ed8/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><ul>
<li>chrome导入密码后，无反应</li>
<li>chrome保存密码，也没有任何提示</li>
</ul>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><ul>
<li>浏览器中输入<code>chrome://flags/</code>，找到<code>Password import</code>，把值重新禁止和打开。</li>
</ul>
<blockquote>
<p>此操作也使用无导入密码按钮的问题</p>
</blockquote>
<p><img src="/aposts/9dc1ed8/image-20220822094625395.png" alt="image-20220822094625395"></p>
<ul>
<li>运行中输入：<code>%LOCALAPPDATA%\Google\Chrome\User Data\Default</code>，打开Chrome保存用户信息的路径，删除已经保存的用户信息（Login开头的文件）</li>
</ul>
<p><img src="/aposts/9dc1ed8/image-20220822095203160.png" alt="image-20220822095203160"></p>
<ul>
<li>重启chrome浏览器后，无论是导入密码，还是提示密码保存功能，都已经可以了</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://louis-me.github.io/aposts/3fc2b160/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个正经的测试工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="施坤的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/aposts/3fc2b160/" class="post-title-link" itemprop="url">python之logging</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-08-02 16:38:35 / 修改时间：19:35:03" itemprop="dateCreated datePublished" datetime="2022-08-02T16:38:35+08:00">2022-08-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          
            <span id="/aposts/3fc2b160/" class="post-meta-item leancloud_visitors" data-flag-title="python之logging" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/aposts/3fc2b160/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/aposts/3fc2b160/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">------------------------------------</span><br><span class="line"># @FileName    :handle_log.py</span><br><span class="line"># @Time        :2020/8/31 19:59</span><br><span class="line"># @Author      :xieyuanzuo</span><br><span class="line"># @description :</span><br><span class="line">------------------------------------</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import logging</span><br><span class="line">import os</span><br><span class="line">import colorlog</span><br><span class="line">from logging.handlers import RotatingFileHandler</span><br><span class="line">from datetime import datetime</span><br><span class="line"></span><br><span class="line">cur_path = os.path.dirname(os.path.realpath(__file__))  # 当前项目路径</span><br><span class="line">log_path = os.path.join(os.path.dirname(cur_path), &#x27;leetcode&#x27;, &#x27;logs&#x27;)  # log_path为存放日志的路径</span><br><span class="line">if not os.path.exists(log_path): os.mkdir(log_path)  # 若不存在logs文件夹，则自动创建</span><br><span class="line"></span><br><span class="line">log_colors_config = &#123;</span><br><span class="line">    # 终端输出日志颜色配置</span><br><span class="line">    &#x27;DEBUG&#x27;: &#x27;white&#x27;,</span><br><span class="line">    &#x27;INFO&#x27;: &#x27;cyan&#x27;,</span><br><span class="line">    &#x27;WARNING&#x27;: &#x27;yellow&#x27;,</span><br><span class="line">    &#x27;ERROR&#x27;: &#x27;red&#x27;,</span><br><span class="line">    &#x27;CRITICAL&#x27;: &#x27;bold_red&#x27;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">default_formats = &#123;</span><br><span class="line">    # 终端输出格式</span><br><span class="line">    &#x27;color_format&#x27;: &#x27;%(log_color)s%(asctime)s-%(name)s-%(filename)s-[line:%(lineno)d]-%(levelname)s: %(message)s&#x27;,</span><br><span class="line">    # 日志输出格式</span><br><span class="line">    &#x27;log_format&#x27;: &#x27;%(asctime)s-%(name)s-%(filename)s-[line:%(lineno)d]-%(levelname)s: %(message)s&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class HandleLog:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    先创建日志记录器（logging.getLogger），然后再设置日志级别（logger.setLevel），</span><br><span class="line">    接着再创建日志文件，也就是日志保存的地方（logging.FileHandler），然后再设置日志格式（logging.Formatter），</span><br><span class="line">    最后再将日志处理程序记录到记录器（addHandler）</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.__now_time = datetime.now().strftime(&#x27;%Y-%m-%d&#x27;)  # 当前日期格式化</span><br><span class="line">        self.__all_log_path = os.path.join(log_path, self.__now_time + &quot;-all&quot; + &quot;.log&quot;)  # 收集所有日志信息文件</span><br><span class="line">        self.__error_log_path = os.path.join(log_path, self.__now_time + &quot;-error&quot; + &quot;.log&quot;)  # 收集错误日志信息文件</span><br><span class="line">        self.__logger = logging.getLogger()  # 创建日志记录器</span><br><span class="line">        self.__logger.setLevel(logging.DEBUG)  # 设置默认日志记录器记录级别</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def __init_logger_handler(log_path):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        创建日志记录器handler，用于收集日志</span><br><span class="line">        :param log_path: 日志文件路径</span><br><span class="line">        :return: 日志记录器</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        # 写入文件，如果文件超过1M大小时，切割日志文件，仅保留3个文件</span><br><span class="line">        logger_handler = RotatingFileHandler(filename=log_path, maxBytes=1 * 1024 * 1024, backupCount=3, encoding=&#x27;utf-8&#x27;)</span><br><span class="line">        return logger_handler</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def __init_console_handle():</span><br><span class="line">        &quot;&quot;&quot;创建终端日志记录器handler，用于输出到控制台&quot;&quot;&quot;</span><br><span class="line">        console_handle = colorlog.StreamHandler()</span><br><span class="line">        return console_handle</span><br><span class="line"></span><br><span class="line">    def __set_log_handler(self, logger_handler, level=logging.DEBUG):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        设置handler级别并添加到logger收集器</span><br><span class="line">        :param logger_handler: 日志记录器</span><br><span class="line">        :param level: 日志记录器级别</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        logger_handler.setLevel(level=level)</span><br><span class="line">        self.__logger.addHandler(logger_handler)</span><br><span class="line"></span><br><span class="line">    def __set_color_handle(self, console_handle):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        设置handler级别并添加到终端logger收集器</span><br><span class="line">        :param console_handle: 终端日志记录器</span><br><span class="line">        :param level: 日志记录器级别</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        console_handle.setLevel(logging.DEBUG)</span><br><span class="line">        self.__logger.addHandler(console_handle)</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def __set_color_formatter(console_handle, color_config):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        设置输出格式-控制台</span><br><span class="line">        :param console_handle: 终端日志记录器</span><br><span class="line">        :param color_config: 控制台打印颜色配置信息</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        formatter = colorlog.ColoredFormatter(default_formats[&quot;color_format&quot;], log_colors=color_config)</span><br><span class="line">        console_handle.setFormatter(formatter)</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def __set_log_formatter(file_handler):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        设置日志输出格式-日志文件</span><br><span class="line">        :param file_handler: 日志记录器</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        formatter = logging.Formatter(default_formats[&quot;log_format&quot;], datefmt=&#x27;%Y-%m-%d %H:%M:%S&#x27;)</span><br><span class="line">        file_handler.setFormatter(formatter)</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def __close_handler(file_handler):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        关闭handler</span><br><span class="line">        :param file_handler: 日志记录器</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        file_handler.close()</span><br><span class="line"></span><br><span class="line">    def __console(self, level, message):</span><br><span class="line">        &quot;&quot;&quot;构造日志收集器&quot;&quot;&quot;</span><br><span class="line">        all_logger_handler = self.__init_logger_handler(self.__all_log_path)  # 创建日志文件</span><br><span class="line">        error_logger_handler = self.__init_logger_handler(self.__error_log_path)</span><br><span class="line">        console_handle = self.__init_console_handle()</span><br><span class="line"></span><br><span class="line">        self.__set_log_formatter(all_logger_handler)  # 设置日志格式</span><br><span class="line">        self.__set_log_formatter(error_logger_handler)</span><br><span class="line">        self.__set_color_formatter(console_handle, log_colors_config)</span><br><span class="line"></span><br><span class="line">        self.__set_log_handler(all_logger_handler)  # 设置handler级别并添加到logger收集器</span><br><span class="line">        self.__set_log_handler(error_logger_handler, level=logging.ERROR)</span><br><span class="line">        self.__set_color_handle(console_handle)</span><br><span class="line"></span><br><span class="line">        if level == &#x27;info&#x27;:</span><br><span class="line">            self.__logger.info(message)</span><br><span class="line">        elif level == &#x27;debug&#x27;:</span><br><span class="line">            self.__logger.debug(message)</span><br><span class="line">        elif level == &#x27;warning&#x27;:</span><br><span class="line">            self.__logger.warning(message)</span><br><span class="line">        elif level == &#x27;error&#x27;:</span><br><span class="line">            self.__logger.error(message)</span><br><span class="line">        elif level == &#x27;critical&#x27;:</span><br><span class="line">            self.__logger.critical(message)</span><br><span class="line"></span><br><span class="line">        self.__logger.removeHandler(all_logger_handler)  # 避免日志输出重复问题</span><br><span class="line">        self.__logger.removeHandler(error_logger_handler)</span><br><span class="line">        self.__logger.removeHandler(console_handle)</span><br><span class="line"></span><br><span class="line">        self.__close_handler(all_logger_handler)  # 关闭handler</span><br><span class="line">        self.__close_handler(error_logger_handler)</span><br><span class="line"></span><br><span class="line">    def debug(self, message):</span><br><span class="line">        self.__console(&#x27;debug&#x27;, message)</span><br><span class="line"></span><br><span class="line">    def info(self, message):</span><br><span class="line">        self.__console(&#x27;info&#x27;, message)</span><br><span class="line"></span><br><span class="line">    def warning(self, message):</span><br><span class="line">        self.__console(&#x27;warning&#x27;, message)</span><br><span class="line"></span><br><span class="line">    def error(self, message):</span><br><span class="line">        self.__console(&#x27;error&#x27;, message)</span><br><span class="line"></span><br><span class="line">    def critical(self, message):</span><br><span class="line">        self.__console(&#x27;critical&#x27;, message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">log = HandleLog()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    for i in range(5):</span><br><span class="line">        log.info(&quot;这是日志信息&quot;)</span><br><span class="line">        log.debug(&quot;这是debug信息&quot;)</span><br><span class="line">        log.warning(&quot;这是警告信息&quot;)</span><br><span class="line">        log.error(&quot;这是错误日志信息&quot;)</span><br><span class="line">        log.critical(&quot;这是严重级别信息&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="结果分析"><a href="#结果分析" class="headerlink" title="结果分析"></a>结果分析</h2><ul>
<li>在Logs文件夹下生成了一个为全部日志文件，一个为错误日志文件</li>
</ul>
<p><img src="/aposts/3fc2b160/image-20220802192813131.png" alt="image-20220802192813131"></p>
<ul>
<li>日志文件的生成核心代码如下，可根据需求修改</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__console</span>(<span class="params">self, level, message</span>):</span><br><span class="line">      <span class="string">&quot;&quot;&quot;构造日志收集器&quot;&quot;&quot;</span></span><br><span class="line">      all_logger_handler = self.__init_logger_handler(self.__all_log_path)  <span class="comment"># 创建日志文件</span></span><br><span class="line">      error_logger_handler = self.__init_logger_handler(self.__error_log_path)</span><br><span class="line">      console_handle = self.__init_console_handle()</span><br><span class="line"></span><br><span class="line">      self.__set_log_formatter(all_logger_handler)  <span class="comment"># 设置日志格式</span></span><br><span class="line">      self.__set_log_formatter(error_logger_handler)</span><br><span class="line">      self.__set_color_formatter(console_handle, log_colors_config)</span><br><span class="line"></span><br><span class="line">      self.__set_log_handler(all_logger_handler)  <span class="comment"># 设置handler级别并添加到logger收集器--all的Log文件</span></span><br><span class="line">      self.__set_log_handler(error_logger_handler, level=logging.ERROR) <span class="comment">#--error的log文件</span></span><br><span class="line">      self.__set_color_handle(console_handle)</span><br></pre></td></tr></table></figure>

<ul>
<li>注意这里设置了日志文件大小</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init_logger_handler</span>(<span class="params">log_path</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        创建日志记录器handler，用于收集日志</span></span><br><span class="line"><span class="string">        :param log_path: 日志文件路径</span></span><br><span class="line"><span class="string">        :return: 日志记录器</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 写入文件，如果文件超过1M大小时，切割日志文件，仅保留3个文件</span></span><br><span class="line">        logger_handler = RotatingFileHandler(filename=log_path, maxBytes=<span class="number">1</span> * <span class="number">1024</span> * <span class="number">1024</span>, backupCount=<span class="number">3</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> logger_handler</span><br></pre></td></tr></table></figure>

<ul>
<li>本次代码来自<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xyztank/articles/13599165.html">这里</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">


    <div class="sidebar-inner">



      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt=""
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description">一个正经的测试工程师</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">155</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">64</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Louis-me" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Louis-me" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:shikun.job@foxmail.com" title="E-Mail → mailto:shikun.job@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>
  <!-- 标签云 -->

<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <!--<h3 class="widget-title">Tag Cloud</h3> -->
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width=100%">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AWVS/" rel="tag">AWVS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/" rel="tag">Android</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Burp-Site/" rel="tag">Burp Site</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DVWA/" rel="tag">DVWA</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dependency-Check/" rel="tag">Dependency-Check</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/H5/" rel="tag">H5</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hadoop/" rel="tag">Hadoop</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hive/" rel="tag">Hive</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Metasploit/" rel="tag">Metasploit</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nessus/" rel="tag">Nessus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sonic/" rel="tag">Sonic</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/airtest/" rel="tag">airtest</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/" rel="tag">android</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" rel="tag">android性能测试</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/app%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/" rel="tag">app安全测试</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aritest/" rel="tag">aritest</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/" rel="tag">centos</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome/" rel="tag">chrome</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/datax/" rel="tag">datax</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/" rel="tag">django</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/drozer/" rel="tag">drozer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fisco-bcos/" rel="tag">fisco-bcos</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flink/" rel="tag">flink</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gin/" rel="tag">gin</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/" rel="tag">go</a><span class="tag-list-count">16</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go-zero/" rel="tag">go-zero</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hive/" rel="tag">hive</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/httprunner/" rel="tag">httprunner</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jmeter/" rel="tag">jmeter</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/" rel="tag">kafka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kail/" rel="tag">kail</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/" rel="tag">leetcode</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode-%E6%95%B0%E7%BB%84/" rel="tag">leetcode-数组</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mitmproxy/" rel="tag">mitmproxy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/monkey/" rel="tag">monkey</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandas/" rel="tag">pandas</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pc%E8%87%AA%E5%8A%A8%E5%8C%96/" rel="tag">pc自动化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/playwright/" rel="tag">playwright</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pytest/" rel="tag">pytest</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/selenium/" rel="tag">selenium</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlite/" rel="tag">sqlite</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlmap/" rel="tag">sqlmap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tkinter/" rel="tag">tkinter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue3/" rel="tag">vue3</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="tag">云服务器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag">大数据</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/" rel="tag">安全测试</a><span class="tag-list-count">29</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" rel="tag">性能测试</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" rel="tag">环境搭建</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" rel="tag">自动化测试</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0/" rel="tag">英语学习</a><span class="tag-list-count">1</span></li></ul>
        </canvas>
    </div>
</div>

</div>
<!-- 标签云 -->
    </div>

  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  <a href="https://beian.miit.gov.cn/" target="_blank">湘ICP备2022002212号-1</a><br />
  <!--
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>
  -->
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>


        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script src='../../../js/src/av-min.js'></script>
<script src='../../../js/src/Valine.min.js'></script>

<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : true,
      notify     : false,
      appId      : 'mhSm1aOQmnVeiAUJxrsKIFg5-gzGzoHsz',
      appKey     : 'kW6GQVoeJac7wDgKvy9vXhn6',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
